<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>ğŸ„ Evento de Navidad â€” Pekeweb ğŸ</title>
<style>
body{
  margin:0;
  padding:0;
  font-family:Arial, sans-serif;
  color:#fff;
  background: linear-gradient(180deg, #0b1a2a 0%, #123456 100%);
  background-attachment: fixed;
  overflow-x:hidden;
  position:relative;
}

header{
  text-align:center;
  padding:10px;
  font-size:2rem;
  font-weight: bold;
  text-shadow:0 0 15px rgba(255,255,255,0.4);
  display:flex;
  justify-content:space-between;
  align-items:center;
}

header button{
  padding:8px 12px;
  font-size:1rem;
  border:none;
  border-radius:6px;
  background:#b31e1e;
  color:#fff;
  cursor:pointer;
}

.container{
  max-width:1100px;
  margin:0 auto;
  padding:20px;
}

#alertaMes{
  background:#b31e1e;
  padding:15px;
  border-radius:10px;
  margin-bottom:20px;
  display:none;
  text-align:center;
  font-weight:bold;
}

.calendar{
  display:grid;
  grid-template-columns: repeat(6,1fr);
  gap:10px;
  margin-bottom:30px;
}

.day{
  background:#1d3557;
  border-radius:10px;
  padding:20px;
  text-align:center;
  font-size:1.4rem;
  cursor:pointer;
  transition:0.3s;
  border:2px solid rgba(255,255,255,0.2);
  user-select:none;
}

.day.disabled{
  background:#15263a;
  cursor:not-allowed;
  opacity:0.4;
}

.day.opened{
  background:#2a9d8f;
  transform: scale(1.05);
}

h2{
  margin-top:40px;
  text-shadow:0 0 10px rgba(255,255,255,0.3);
}

.coleccionables-grid{
  display:grid;
  grid-template-columns: repeat(auto-fill,minmax(120px,1fr));
  gap:15px;
  margin-top:15px;
}

.item-col{
  background:#1d2a38;
  padding:10px;
  border-radius:10px;
  text-align:center;
  border:2px solid rgba(255,255,255,0.2);
  font-size:1.4rem;
}

.item-col.locked{
  opacity:0.4;
  filter: grayscale(100%);
}

.snow-container{
  margin-top:30px;
  background:#162330;
  border-radius:10px;
  padding:20px;
  border:1px solid rgba(255,255,255,0.2);
}

.snow-list div{
  padding:5px;
  margin:5px 0;
  border-bottom:1px dashed rgba(255,255,255,0.2);
}

.hidden-snowman{
  position:absolute;
  font-size:2rem;
  cursor:pointer;
  transition:0.25s;
}

.hidden-snowman.catched{
  opacity:0;
  transform:scale(0);
}
</style>
</head>
<body>

<header>
  <span>ğŸ„ Evento de Navidad â€” Pekeweb ğŸ</span>
  <button onclick="location.href='h.html'">â¬… Volver</button>
</header>

<!-- 5 muÃ±ecos por esta zona -->
<div class="hidden-snowman" data-id="1">â›„</div>
<div class="hidden-snowman" data-id="2">â›„</div>
<div class="hidden-snowman" data-id="3">â›„</div>
<div class="hidden-snowman" data-id="4">â›„</div>
<div class="hidden-snowman" data-id="5">â›„</div>

<div class="container">
  <div id="alertaMes">âŒ El calendario solo estÃ¡ disponible en DICIEMBRE.</div>

  <h2>ğŸ… Calendario de Adviento</h2>
  <div class="calendar" id="calendar"></div>

  <h2>â­ Coleccionables</h2>
  <div class="coleccionables-grid" id="coleccionables"></div>

  <div class="snow-container">
    <h2>â›„ MuÃ±ecos de nieve recogidos</h2>
    <p>Total: <b id="snowCount">0</b></p>
    <div class="snow-list" id="snowList"></div>
  </div>
</div>

<script>
// ==================== CALENDARIO ====================
const today = new Date();
const currentDay = today.getDate();
const currentMonth = today.getMonth();
const calendar = document.getElementById("calendar");
const alertaMes = document.getElementById("alertaMes");
let daysOpened = JSON.parse(localStorage.getItem("daysOpened")) || [];

const dailyMessages = [
  "Â¡Disfruta de un chocolate caliente! â˜•â„ï¸",
  "Cuelga tus calcetines navideÃ±os ğŸ„ğŸ§¦",
  "Â¡Mira las luces de Navidad! âœ¨",
  "No olvides cantar villancicos ğŸ¶ğŸ…",
  "Decora tu Ã¡rbol de Navidad ğŸ„ğŸŒŸ",
  "Es hora de hornear galletas ğŸª",
  "EnvÃ­a una tarjeta navideÃ±a a un amigo ğŸ’Œ",
  "Pon villancicos en tu playlist ğŸµ",
  "Abre un regalo virtual ğŸ",
  "Â¡Siente la magia de la Navidad! â„ï¸âœ¨"
];

// 12 dÃ­as con coleccionable
const dailyContent = {
  1: { type:"collectible", itemId:1 },
  3: { type:"collectible", itemId:2 },
  5: { type:"collectible", itemId:3 },
  7: { type:"collectible", itemId:4 },
  9: { type:"collectible", itemId:5 },
  11:{ type:"collectible", itemId:6 },
  13:{ type:"collectible", itemId:7 },
  15:{ type:"collectible", itemId:8 },
  17:{ type:"collectible", itemId:9 },
  19:{ type:"collectible", itemId:10 },
  21:{ type:"collectible", itemId:11 },
  23:{ type:"collectible", itemId:12 }
};

for(let i = 1; i <= 24; i++){
  const day = document.createElement("div");
  day.classList.add("day");
  day.textContent = i;

  if(currentMonth !== 11) day.classList.add("disabled");
  else if(i > currentDay) day.classList.add("disabled");

  if(daysOpened.includes(i)){
    day.classList.add("opened");
    day.textContent="ğŸ";
  }

  day.addEventListener("click", () => {
    if(day.classList.contains("disabled")) return;

    day.classList.add("opened");
    day.textContent="ğŸ";

    if(!daysOpened.includes(i)){
      daysOpened.push(i);
      localStorage.setItem("daysOpened", JSON.stringify(daysOpened));
    }

    if(dailyContent[i]) showContent(dailyContent[i]);
    else{
      const msg = dailyMessages[Math.floor(Math.random()*dailyMessages.length)];
      alert(msg);
    }
  });

  calendar.appendChild(day);
}

function showContent(content){
  if(content.type==="message") alert(content.text);
  else if(content.type==="collectible"){
    unlockCollectible(content.itemId);
    alert("â­ Â¡Coleccionable desbloqueado!");
  }
}

// ==================== COLECCIONABLES ====================
const coleccionables = document.getElementById("coleccionables");
let coleccion = JSON.parse(localStorage.getItem("coleccionables"));

if(!coleccion){
  const total = 22;
  const emojiList = ["ğŸ","ğŸ„","â›„","â„ï¸","ğŸ¦Œ","ğŸª","ğŸ•¯ï¸","ğŸ…","ğŸŒŸ","ğŸ§¦","ğŸ«","ğŸ””",
                     "ğŸ›·","ğŸ‰","ğŸ·","ğŸ¥§","ğŸŒ²","ğŸ¶","ğŸ§¸","ğŸ­","ğŸ©","ğŸ¥‚"];
  coleccion = [];
  for(let i=0;i<total;i++) coleccion.push({id:i+1,nombre:emojiList[i],unlocked:false});
  localStorage.setItem("coleccionables", JSON.stringify(coleccion));
}

function renderCollectibles(){
  coleccionables.innerHTML="";
  coleccion.forEach(c=>{
    const div=document.createElement("div");
    div.classList.add("item-col");
    if(!c.unlocked) div.classList.add("locked");
    div.textContent = c.unlocked ? c.nombre : "???";
    coleccionables.appendChild(div);
  });
}
renderCollectibles();

function unlockCollectible(id){
  if(coleccion[id-1] && !coleccion[id-1].unlocked){
    coleccion[id-1].unlocked=true;
    localStorage.setItem("coleccionables", JSON.stringify(coleccion));
    renderCollectibles();
  }
}

// ==================== MUÃ‘ECOS ESCONDIDOS ====================
let snowmen = JSON.parse(localStorage.getItem("snowmen")) || [];
let collectedIDs = JSON.parse(localStorage.getItem("collectedSnowmenIDs")) || [];
const snowList = document.getElementById("snowList");
const snowCount = document.getElementById("snowCount");

function updateSnowList(){
  snowList.innerHTML="";
  snowmen.forEach(n=>{
    const div=document.createElement("div");
    div.textContent=n;
    snowList.appendChild(div);
  });
  snowCount.textContent=snowmen.length;
}
updateSnowList();

document.querySelectorAll(".hidden-snowman").forEach(sm=>{
  const id = sm.dataset.id;

  // PosiciÃ³n aleatoria en la ventana (considerando un margen)
  const padding = 50; // margen para que no se salga de la pantalla
  const maxX = window.innerWidth - 50;
  const maxY = window.innerHeight - 150; // dejando espacio para header
  sm.style.left = (Math.random() * (maxX - padding) + padding) + "px";
  sm.style.top = (Math.random() * (maxY - padding) + padding) + "px";

  // Ocultar si ya recogido
  if(collectedIDs.includes(id)) sm.style.display="none";

  sm.addEventListener("click", ()=>{
    if(collectedIDs.includes(id)) return;

    sm.classList.add("catched");
    setTimeout(()=> sm.style.display="none", 200);

    snowmen.push("MuÃ±eco #" + (snowmen.length + 1));
    localStorage.setItem("snowmen", JSON.stringify(snowmen));

    collectedIDs.push(id);
    localStorage.setItem("collectedSnowmenIDs", JSON.stringify(collectedIDs));

    updateSnowList();

    if(snowmen.length % 5 === 0){
      const index = 12 + (snowmen.length/5);
      unlockCollectible(index);
      alert("â„ï¸ Has conseguido 5 muÃ±ecos â†’ Coleccionable desbloqueado!");
    }
  });
});
</script>

</body>
</html>
