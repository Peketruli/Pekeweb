<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Consola Administrativa</title>
<style>
  body { font-family: Arial; background: #111; color: #fff; padding: 20px; }
  table { width: 100%; border-collapse: collapse; margin-top: 20px; }
  th, td { border: 1px solid #444; padding: 8px; text-align: left; }
  th { background: #222; }
</style>
</head>
<body>
<h1>Consola de Movimientos</h1>
<table>
  <thead>
    <tr>
      <th>ID</th>
      <th>Usuario</th>
      <th>Acci√≥n</th>
      <th>IP</th>
      <th>Fecha</th>
    </tr>
  </thead>
  <tbody id="logsBody">
    <tr><td colspan="5">Cargando...</td></tr>
  </tbody>
</table>

<script type="module">
import { createClient } from 'https://cdn.jsdelivr.net/npm/@supabase/supabase-js/+esm'

const supabaseUrl = 'TU_SUPABASE_URL'
const supabaseKey = 'TU_SUPABASE_ANON_KEY'
const supabase = createClient(supabaseUrl, supabaseKey)

async function cargarLogs() {
  const { data: logs, error } = await supabase
    .from('logs')
    .select('id, action, ip, created_at, user:usuarios(username)')
    .order('created_at', { ascending: false })
    .limit(100)

  const tbody = document.getElementById('logsBody')
  if (error) {
    tbody.innerHTML = `<tr><td colspan="5">Error: ${error.message}</td></tr>`
    return
  }

  tbody.innerHTML = logs.map(log => `
    <tr>
      <td>${log.id}</td>
      <td>${log.user?.username || 'Desconocido'}</td>
      <td>${log.action}</td>
      <td>${log.ip}</td>
      <td>${new Date(log.created_at).toLocaleString()}</td>
    </tr>
  `).join('')
}

// Actualizar cada 10 segundos
cargarLogs()
setInterval(cargarLogs, 10000)
</script>
</body>
</html>
