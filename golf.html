<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Zona de Juegos</title>
<style>
body {
  margin: 0;
  font-family: Arial, sans-serif;
  background: #000;
  color: #fff;
  overflow: hidden;
}
#menu, #gameArea, #playScreen {
  position: absolute;
  top: 0; left: 0;
  width: 100%; height: 100%;
  display: flex;
  justify-content: center;
  align-items: center;
  flex-direction: column;
}
#menu { background: radial-gradient(circle at center, #111, #000); }
.card {
  background: #222;
  padding: 20px;
  margin: 10px;
  border-radius: 10px;
  cursor: pointer;
  width: 200px;
  text-align: center;
  transition: 0.2s;
}
.card:hover { background: #444; transform: scale(1.05); }
#gameArea { display: none; flex-direction: column; }
#playScreen { display: none; background: rgba(0,0,0,0.9); }
button {
  margin-top: 10px;
  padding: 10px 25px;
  border: none;
  border-radius: 8px;
  background: #0af;
  color: #fff;
  font-weight: bold;
  cursor: pointer;
  transition: 0.2s;
}
button:hover { background: #09f; }
#scoreBoard {
  position: absolute;
  top: 10px; left: 10px;
  font-size: 18px;
  background: rgba(0,0,0,0.4);
  padding: 6px 10px;
  border-radius: 6px;
}
canvas { background: #000; border: 2px solid #333; border-radius: 10px; }
</style>
</head>
<body>

<div id="menu">
  <h1>游꿡 Zona de Juegos</h1>
  <div class="card" onclick="loadGame('pacman')">Pac-Man</div>
  <div class="card" onclick="loadGame('buscaminas')">Buscaminas</div>
  <div class="card" onclick="loadGame('solitario')">Solitario</div>
  <div class="card" onclick="loadGame('flota')">Hundir la flota</div>
</div>

<div id="playScreen">
  <h2 id="gameTitle"></h2>
  <button onclick="startGame()">Play</button>
  <button onclick="backToMenu()">Volver</button>
</div>

<div id="gameArea">
  <div id="scoreBoard"></div>
  <div id="gameContainer"></div>
  <button onclick="backToMenu()" style="position:absolute;bottom:15px;">Volver al men칰</button>
</div>

<script>
let currentGame = null;

// --- CONTROL DE VISTAS ---
function loadGame(game){
  currentGame = game;
  document.getElementById('menu').style.display='none';
  document.getElementById('playScreen').style.display='flex';
  document.getElementById('gameTitle').innerText =
    game==='pacman' ? 'Pac-Man' :
    game==='buscaminas' ? 'Buscaminas' :
    game==='solitario' ? 'Solitario' :
    'Hundir la Flota';
}

function startGame(){
  document.getElementById('playScreen').style.display='none';
  document.getElementById('gameArea').style.display='flex';
  const container=document.getElementById('gameContainer');
  container.innerHTML='';
  document.getElementById('scoreBoard').innerText='';
  switch(currentGame){
    case 'pacman': initPacman(container); break;
    default:
      container.innerHTML='<p>Juego en desarrollo...</p>';
  }
}

function backToMenu(){
  document.getElementById('menu').style.display='flex';
  document.getElementById('gameArea').style.display='none';
  document.getElementById('playScreen').style.display='none';
  document.getElementById('gameContainer').innerHTML='';
  document.getElementById('scoreBoard').innerText='';
}

// --- PACMAN V2 ---
function initPacman(container){
  const canvas=document.createElement('canvas');
  const ctx=canvas.getContext('2d');
  canvas.width=448; canvas.height=496; // Tama침o cl치sico (28x31 celdas)
  container.appendChild(canvas);
  
  const tileSize=16;
  const map=[
"############################",
"#............##............#",
"#.####.#####.##.#####.####.#",
"#o####.#####.##.#####.####o#",
"#.####.#####.##.#####.####.#",
"#..........................#",
"#.####.##.########.##.####.#",
"#.####.##.########.##.####.#",
"#......##....##....##......#",
"######.##### ## #####.######",
"######.##### ## #####.######",
"######.##          ##.######",
"######.## ###--### ##.######",
"######.## #      # ##.######",
"       .  #      #  .       ",
"######.## #      # ##.######",
"######.## ######## ##.######",
"######.##          ##.######",
"######.## ######## ##.######",
"######.## ######## ##.######",
"#............##............#",
"#.####.#####.##.#####.####.#",
"#o####.#####.##.#####.####o#",
"#...##................##...#",
"###.##.##.########.##.##.###",
"###.##.##.########.##.##.###",
"#......##....##....##......#",
"#.##########.##.##########.#",
"#.##########.##.##########.#",
"#..........................#",
"############################"
];
  let score=0;
  let px=13*tileSize, py=23*tileSize;
  let vx=0, vy=0, nextVx=0, nextVy=0;
  let mouthAngle=0, mouthDir=1;
  const speed=1.8;

  function canMove(nx,ny){
    const cx=Math.floor(nx/tileSize);
    const cy=Math.floor(ny/tileSize);
    const char=map[cy]?.[cx];
    return char && char!=='#';
  }

  document.addEventListener('keydown', e=>{
    switch(e.key){
      case 'ArrowUp': nextVx=0; nextVy=-speed; break;
      case 'ArrowDown': nextVx=0; nextVy=speed; break;
      case 'ArrowLeft': nextVx=-speed; nextVy=0; break;
      case 'ArrowRight': nextVx=speed; nextVy=0; break;
    }
  });

  function loop(){
    // Si puede girar, actualiza direcci칩n
    if(canMove(px+nextVx,py+nextVy)) { vx=nextVx; vy=nextVy; }

    // Movimiento
    if(canMove(px+vx,py+vy)){ px+=vx; py+=vy; }

    // Comer puntos
    const cx=Math.floor(px/tileSize);
    const cy=Math.floor(py/tileSize);
    if(map[cy]?.[cx]==='.'){
      map[cy]=map[cy].substring(0,cx)+' '+map[cy].substring(cx+1);
      score+=10;
    } else if(map[cy]?.[cx]==='o'){
      map[cy]=map[cy].substring(0,cx)+' '+map[cy].substring(cx+1);
      score+=50;
    }

    // Animaci칩n boca
    mouthAngle+=mouthDir*0.2;
    if(mouthAngle>1 || mouthAngle<0) mouthDir*=-1;

    // Dibujo
    ctx.clearRect(0,0,canvas.width,canvas.height);
    for(let y=0;y<map.length;y++){
      for(let x=0;x<map[y].length;x++){
        const c=map[y][x];
        if(c==='#'){ ctx.fillStyle='#1919A6'; ctx.fillRect(x*tileSize,y*tileSize,tileSize,tileSize); }
        else if(c==='.'||c==='o'){
          ctx.fillStyle='orange';
          const r=(c==='o')?4:2;
          ctx.beginPath();
          ctx.arc(x*tileSize+tileSize/2,y*tileSize+tileSize/2,r,0,Math.PI*2);
          ctx.fill();
        }
      }
    }
    // Pac-Man
    ctx.fillStyle='yellow';
    ctx.beginPath();
    let angleStart, angleEnd;
    if(vx>0){ angleStart=mouthAngle; angleEnd=2*Math.PI-mouthAngle; }
    else if(vx<0){ angleStart=Math.PI+mouthAngle; angleEnd=Math.PI-mouthAngle; }
    else if(vy>0){ angleStart=Math.PI/2+mouthAngle; angleEnd=Math.PI/2-mouthAngle; }
    else if(vy<0){ angleStart=-Math.PI/2+mouthAngle; angleEnd=-Math.PI/2-mouthAngle; }
    else { angleStart=0; angleEnd=2*Math.PI; }
    ctx.moveTo(px+tileSize/2,py+tileSize/2);
    ctx.arc(px+tileSize/2,py+tileSize/2,tileSize/2,angleStart,angleEnd);
    ctx.closePath();
    ctx.fill();

    document.getElementById('scoreBoard').innerText='Puntuaci칩n: '+score;

    requestAnimationFrame(loop);
  }
  loop();
}
</script>

</body>
</html>
