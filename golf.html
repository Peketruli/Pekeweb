<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>F1 3D</title>
<style>
body { margin:0; overflow:hidden; background:#87CEEB; }
#ui { position:absolute; top:10px; left:10px; color:white; font-family:sans-serif; font-size:16px; background:rgba(0,0,0,0.5); padding:8px; border-radius:6px;}
</style>
</head>
<body>
<div id="ui">Velocidad: <span id="speed">0</span></div>
<script src="https://unpkg.com/three@0.159.0/build/three.min.js"></script>
<script>
// ===== ESCENA Y CÁMARA =====
const scene = new THREE.Scene();
const camera = new THREE.PerspectiveCamera(75, innerWidth/innerHeight, 0.1, 1000);
const renderer = new THREE.WebGLRenderer({antialias:true});
renderer.setSize(innerWidth, innerHeight);
document.body.appendChild(renderer.domElement);

// ===== LUCES =====
const light = new THREE.DirectionalLight(0xffffff,1);
light.position.set(10,20,10); scene.add(light);
scene.add(new THREE.AmbientLight(0x404040));

// ===== PISTA =====
const pistaGeom = new THREE.PlaneGeometry(20,200);
const pistaMat = new THREE.MeshStandardMaterial({color:0x333333});
const pista = new THREE.Mesh(pistaGeom,pistaMat);
pista.rotation.x = -Math.PI/2;
scene.add(pista);

// Bordes
const wallMat = new THREE.MeshStandardMaterial({color:0x228B22});
const leftWall = new THREE.Mesh(new THREE.BoxGeometry(0.5,2,200), wallMat);
leftWall.position.set(-10,1,0);
const rightWall = new THREE.Mesh(new THREE.BoxGeometry(0.5,2,200), wallMat);
rightWall.position.set(10,1,0);
scene.add(leftWall,rightWall);

// ===== COCHE =====
const carGeom = new THREE.BoxGeometry(1,0.5,2);
const carMat = new THREE.MeshStandardMaterial({color:0xff0000});
const car = new THREE.Mesh(carGeom,carMat);
car.position.y = 0.25;
car.position.z = -90;
scene.add(car);

// ===== VARIABLES JUEGO =====
let speed = 0;
const maxSpeed = 1.5;
const accel = 0.02;
const brake = 0.04;
const friction = 0.98;
let turn = 0;

// Teclas
const keys = {};
document.addEventListener('keydown', e=>keys[e.key.toLowerCase()]=true);
document.addEventListener('keyup', e=>keys[e.key.toLowerCase()]=false);

// UI
const speedUI = document.getElementById("speed");

// ===== LOOP =====
function animate(){
  requestAnimationFrame(animate);

  // Aceleración
  if(keys['arrowup']) speed += accel;
  if(keys['arrowdown']) speed -= brake;
  speed *= friction;
  speed = Math.max(Math.min(speed,maxSpeed),-maxSpeed);
  speedUI.textContent = speed.toFixed(2);

  // Giro
  if(keys['arrowleft']) car.rotation.y += 0.03 * (speed/maxSpeed);
  if(keys['arrowright']) car.rotation.y -= 0.03 * (speed/maxSpeed);

  // Movimiento
  car.position.x -= Math.sin(car.rotation.y)*speed;
  car.position.z -= Math.cos(car.rotation.y)*speed;

  // Cámara detrás del coche
  camera.position.x = car.position.x - Math.sin(car.rotation.y)*5;
  camera.position.y = car.position.y + 3;
  camera.position.z = car.position.z - Math.cos(car.rotation.y)*5;
  camera.lookAt(car.position);

  // Mantener coche dentro pista
  car.position.x = Math.max(-9.5,Math.min(9.5,car.position.x));

  renderer.render(scene,camera);
}
animate();

window.addEventListener("resize",()=>{
  camera.aspect = innerWidth/innerHeight;
  camera.updateProjectionMatrix();
  renderer.setSize(innerWidth,innerHeight);
});
</script>
</body>
</html>
