<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Zona de Juegos</title>
<style>
body {
  margin: 0;
  font-family: Arial, sans-serif;
  background: #000;
  color: #fff;
  overflow: hidden;
}
#menu, #gameArea, #playScreen {
  position: absolute;
  top: 0; left: 0;
  width: 100%; height: 100%;
  display: flex;
  justify-content: center;
  align-items: center;
  flex-direction: column;
}
#menu { background: radial-gradient(circle at center, #111, #000); }
.card {
  background: #222;
  padding: 20px;
  margin: 10px;
  border-radius: 10px;
  cursor: pointer;
  width: 200px;
  text-align: center;
  transition: 0.2s;
}
.card:hover { background: #444; transform: scale(1.05); }
#gameArea { display: none; flex-direction: column; }
#playScreen { display: none; background: rgba(0,0,0,0.9); }
button {
  margin-top: 10px;
  padding: 10px 25px;
  border: none;
  border-radius: 8px;
  background: #0af;
  color: #fff;
  font-weight: bold;
  cursor: pointer;
  transition: 0.2s;
}
button:hover { background: #09f; }
#scoreBoard {
  position: absolute;
  top: 10px; left: 10px;
  font-size: 18px;
  background: rgba(0,0,0,0.4);
  padding: 6px 10px;
  border-radius: 6px;
}
canvas { background: #000; border: 2px solid #333; border-radius: 10px; }
</style>
</head>
<body>

<!-- MENÃš PRINCIPAL -->
<div id="menu">
  <h1>ðŸŽ® Zona de Juegos</h1>
  <div class="card" onclick="loadGame('pacman')">Pac-Man</div>
  <div class="card" onclick="loadGame('buscaminas')">Buscaminas</div>
  <div class="card" onclick="loadGame('solitario')">Solitario</div>
  <div class="card" onclick="loadGame('flota')">Hundir la flota</div>
</div>

<!-- PANTALLA DE PLAY -->
<div id="playScreen">
  <h2 id="gameTitle"></h2>
  <button onclick="startGame()">Play</button>
  <button onclick="backToMenu()">Volver</button>
</div>

<!-- ZONA DE JUEGO -->
<div id="gameArea">
  <div id="scoreBoard"></div>
  <div id="gameContainer"></div>
  <button onclick="backToMenu()" style="position:absolute;bottom:15px;">Volver al menÃº</button>
</div>

<script>
let currentGame = null;

// --- CONTROL DE MENÃš Y TRANSICIONES ---
function loadGame(game){
  currentGame = game;
  document.getElementById('menu').style.display='none';
  document.getElementById('playScreen').style.display='flex';
  document.getElementById('gameArea').style.display='none';
  document.getElementById('gameTitle').innerText =
    game==='pacman' ? 'Pac-Man' :
    game==='buscaminas' ? 'Buscaminas' :
    game==='solitario' ? 'Solitario' :
    'Hundir la Flota';
}

function startGame(){
  document.getElementById('playScreen').style.display='none';
  document.getElementById('gameArea').style.display='flex';
  const container=document.getElementById('gameContainer');
  container.innerHTML='';
  document.getElementById('scoreBoard').innerText='';
  switch(currentGame){
    case 'pacman': initPacman(container); break;
    default:
      container.innerHTML='<p>Juego en desarrollo...</p>';
  }
}

function backToMenu(){
  document.getElementById('menu').style.display='flex';
  document.getElementById('gameArea').style.display='none';
  document.getElementById('playScreen').style.display='none';
  document.getElementById('gameContainer').innerHTML='';
  document.getElementById('scoreBoard').innerText='';
}

// --- PACMAN CON FANTASMAS + TÃšNEL ---
function initPacman(container){
  const canvas=document.createElement('canvas');
  const ctx=canvas.getContext('2d');
  canvas.width=448; canvas.height=496;
  container.appendChild(canvas);
  
  const tileSize=16;
  const map=[
"############################",
"#............##............#",
"#.####.#####.##.#####.####.#",
"#o####.#####.##.#####.####o#",
"#.####.#####.##.#####.####.#",
"#..........................#",
"#.####.##.########.##.####.#",
"#.####.##.########.##.####.#",
"#......##....##....##......#",
"######.##### ## #####.######",
"######.##### ## #####.######",
"######.##          ##.######",
"######.## ###--### ##.######",
"######.## #      # ##.######",
"       .  #      #  .       ",
"######.## #      # ##.######",
"######.## ######## ##.######",
"######.##          ##.######",
"######.## ######## ##.######",
"######.## ######## ##.######",
"#............##............#",
"#.####.#####.##.#####.####.#",
"#o####.#####.##.#####.####o#",
"#...##................##...#",
"###.##.##.########.##.##.###",
"###.##.##.########.##.##.###",
"#......##....##....##......#",
"#.##########.##.##########.#",
"#.##########.##.##########.#",
"#..........................#",
"############################"
];

  let score=0;
  let px=13*tileSize, py=23*tileSize;
  let vx=0, vy=0, nextVx=0, nextVy=0;
  let mouthAngle=0, mouthDir=1;
  const speed=1.5;
  let lives=3;

  const ghosts=[
    {x:13*tileSize, y:11*tileSize, color:'red', dir:{x:1,y:0}},
    {x:14*tileSize, y:11*tileSize, color:'pink', dir:{x:-1,y:0}},
    {x:12*tileSize, y:11*tileSize, color:'cyan', dir:{x:0,y:1}},
    {x:15*tileSize, y:11*tileSize, color:'orange', dir:{x:0,y:-1}},
  ];

  function canMove(nx,ny){
    const cx=Math.floor(nx/tileSize);
    const cy=Math.floor(ny/tileSize);
    const char=map[cy]?.[cx];
    return char && char!=='#';
  }

  document.addEventListener('keydown', e=>{
    switch(e.key){
      case 'ArrowUp': nextVx=0; nextVy=-speed; break;
      case 'ArrowDown': nextVx=0; nextVy=speed; break;
      case 'ArrowLeft': nextVx=-speed; nextVy=0; break;
      case 'ArrowRight': nextVx=speed; nextVy=0; break;
    }
  });

  function resetPositions(){
    px=13*tileSize; py=23*tileSize;
    vx=vy=nextVx=nextVy=0;
    ghosts.forEach((g,i)=>{
      g.x=(13+i%2)*tileSize;
      g.y=(11+i)*tileSize/2;
    });
  }

  function moveGhosts(){
    ghosts.forEach(g=>{
      const dirs=[{x:1,y:0},{x:-1,y:0},{x:0,y:1},{x:0,y:-1}];
      const options=dirs.filter(d=>canMove(g.x+d.x*speed,g.y+d.y*speed));
      const dist=Math.hypot(px-g.x,py-g.y);
      if(dist<80){
        g.dir.x=Math.sign(px-g.x);
        g.dir.y=Math.sign(py-g.y);
      } else if(Math.random()<0.05 && options.length>0){
        g.dir=options[Math.floor(Math.random()*options.length)];
      }
      if(canMove(g.x+g.dir.x*speed,g.y+g.dir.y*speed)){
        g.x+=g.dir.x*speed;
        g.y+=g.dir.y*speed;
      }
      if(g.x<-tileSize) g.x=canvas.width;
      if(g.x>canvas.width) g.x=-tileSize;
    });
  }

  function loop(){
    if(canMove(px+nextVx,py+nextVy)) { vx=nextVx; vy=nextVy; }
    if(canMove(px+vx,py+vy)){ px+=vx; py+=vy; }

    // TÃºnel lateral
    if(px<-tileSize) px=canvas.width;
    if(px>canvas.width) px=-tileSize;

    // Comer puntos
    const cx=Math.floor(px/tileSize);
    const cy=Math.floor(py/tileSize);
    if(map[cy]?.[cx]==='.'){
      map[cy]=map[cy].substring(0,cx)+' '+map[cy].substring(cx+1);
      score+=10;
    } else if(map[cy]?.[cx]==='o'){
      map[cy]=map[cy].substring(0,cx)+' '+map[cy].substring(cx+1);
      score+=50;
    }

    moveGhosts();

    // Colisiones
    for(const g of ghosts){
      const dist=Math.hypot(px-g.x,py-g.y);
      if(dist<tileSize/1.2){
        lives--;
        if(lives<=0){
          alert('Â¡Game Over! PuntuaciÃ³n: '+score);
          backToMenu();
          return;
        } else {
          resetPositions();
          return;
        }
      }
    }

    mouthAngle+=mouthDir*0.2;
    if(mouthAngle>1 || mouthAngle<0) mouthDir*=-1;

    // --- DIBUJO ---
    ctx.clearRect(0,0,canvas.width,canvas.height);
    for(let y=0;y<map.length;y++){
      for(let x=0;x<map[y].length;x++){
        const c=map[y][x];
        if(c==='#'){ ctx.fillStyle='#1919A6'; ctx.fillRect(x*tileSize,y*tileSize,tileSize,tileSize); }
        else if(c==='.'||c==='o'){
          ctx.fillStyle='orange';
          const r=(c==='o')?4:2;
          ctx.beginPath();
          ctx.arc(x*tileSize+tileSize/2,y*tileSize+tileSize/2,r,0,Math.PI*2);
          ctx.fill();
        }
      }
    }

    // Pac-Man
    ctx.fillStyle='yellow';
    ctx.beginPath();
    let a1,a2;
    if(vx>0){ a1=mouthAngle; a2=2*Math.PI-mouthAngle; }
    else if(vx<0){ a1=Math.PI+mouthAngle; a2=Math.PI-mouthAngle; }
    else if(vy>0){ a1=Math.PI/2+mouthAngle; a2=Math.PI/2-mouthAngle; }
    else if(vy<0){ a1=-Math.PI/2+mouthAngle; a2=-Math.PI/2-mouthAngle; }
    else { a1=0; a2=2*Math.PI; }
    ctx.moveTo(px+tileSize/2,py+tileSize/2);
    ctx.arc(px+tileSize/2,py+tileSize/2,tileSize/2,a1,a2);
    ctx.closePath();
    ctx.fill();

    // Fantasmas
    ghosts.forEach(g=>{
      ctx.fillStyle=g.color;
      ctx.beginPath();
      ctx.arc(g.x+tileSize/2,g.y+tileSize/2,tileSize/2,Math.PI,0);
      ctx.lineTo(g.x+tileSize,g.y+tileSize);
      ctx.lineTo(g.x,g.y+tileSize);
      ctx.closePath();
      ctx.fill();
    });

    document.getElementById('scoreBoard').innerText=`PuntuaciÃ³n: ${score} | Vidas: ${lives}`;
    requestAnimationFrame(loop);
  }
  loop();
}
</script>
</body>
</html>
