<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Menú de Juegos</title>
<style>
    body {
        font-family: Arial;
        background-color: #111;
        color: #fff;
        text-align: center;
        padding: 50px;
    }

    h1 { color: yellow; }

    .menu button {
        display: block;
        width: 200px;
        margin: 15px auto;
        padding: 10px;
        font-size: 18px;
        cursor: pointer;
        border: none;
        border-radius: 10px;
        background-color: #444;
        color: #fff;
        transition: 0.3s;
    }

    .menu button:hover { background-color: #666; }

    #game-container { margin-top: 30px; }
    .hidden-snowman{
        position:absolute;
        font-size:2rem;
        cursor:pointer;
        transition:0.25s;
        z-index: 100; /* Alto z-index para que esté sobre todo */
    }

    .hidden-snowman.catched{
        opacity:0;
        transform:scale(0);
    }
</style>
</head>
<body>

    <div class="hidden-snowman" data-id="26">⛄</div>
  <div class="hidden-snowman" data-id="27">⛄</div>
  <div class="hidden-snowman" data-id="28">⛄</div>
  <div class="hidden-snowman" data-id="29">⛄</div>
  <div class="hidden-snowman" data-id="30">⛄</div>
    
    <!-- En tu menú principal -->
<button onclick="window.location.href='h.html'">Volver</button>

    <h1>Menú de Juegos</h1>

    <div class="menu">
  
        <button onclick="window.location.href='pacman.html'">Pac-Man</button>
        <button onclick="window.location.href='solitario.html'">Solitario</button>
        <button onclick="window.location.href='buscamias.html'">Buscaminas</button>
          <button onclick="window.location.href='tetris.html'">Tetris</button>
          <button onclick="window.location.href='hundir.html'">Hundir la flota</button>
    </div>

    <div id="game-container"></div>

    <script>
         // ==================== LÓGICA MUÑECOS ESCONDIDOS AÑADIDA ====================
let snowmen = JSON.parse(localStorage.getItem("snowmen")) || [];
let collectedIDs = JSON.parse(localStorage.getItem("collectedSnowmenIDs")) || [];
const firstCollectibleIndex = 13; // Primer coleccionable para muñecos (ID 13)
const maxCollectibleIndex = 22; // Último coleccionable para muñecos (ID 22)


document.addEventListener("DOMContentLoaded", () => {
    // ... (El resto de loadUserInfo y loadBlogs ya están arriba)
    setupSnowmanListeners(); 
});

function unlockCollectible(id){
  // Esta es una función auxiliar que debe estar definida en evento.html para que funcione la lógica de desbloqueo,
    // pero la definimos aquí para evitar errores y simular el guardado.
  // En el blog, solo recogemos y guardamos en localStorage. El desbloqueo visual se hará en evento.html.
    let coleccion = JSON.parse(localStorage.getItem("coleccionables"));
    if(!coleccion) return false;

    if(coleccion[id-1] && !coleccion[id-1].unlocked){
      coleccion[id-1].unlocked=true;
      localStorage.setItem("coleccionables", JSON.stringify(coleccion));
      return true;
    }
    return false;
}

function setupSnowmanListeners() {
    document.querySelectorAll(".hidden-snowman").forEach(sm=>{
        const id = sm.dataset.id;
        
        // Posición aleatoria en la ventana
        const padding = 80; 
        // Usamos document.body.scrollHeight/scrollWidth para posicionar en todo el cuerpo, no solo la vista
        const maxX = window.innerWidth - padding;
        const maxY = document.body.scrollHeight - padding; 
        
        // Intentamos que se posicionen fuera de la zona central del blog-container para que sean "escondidos"
        const isLeft = Math.random() < 0.5;
        
        if (isLeft) {
             // Posicionar en el lado izquierdo (0 a 30% de la ventana)
            sm.style.left = (Math.random() * (window.innerWidth * 0.3 - padding) + padding) + "px";
        } else {
            // Posicionar en el lado derecho (70% al 100% de la ventana)
            sm.style.left = (window.innerWidth * 0.7 + Math.random() * (window.innerWidth * 0.3 - padding) + padding) + "px";
        }

        // Posición vertical aleatoria
        sm.style.top = (Math.random() * (maxY - 200) + 200) + "px"; // 200px para evitar el header

        // Ocultar si ya recogido
        if(collectedIDs.includes(id)) sm.style.display="none";

        sm.addEventListener("click", ()=>{
            if(collectedIDs.includes(id)) return;

            sm.classList.add("catched");
            setTimeout(()=> sm.style.display="none", 200);

            // Guardar en el array de muñecos
            snowmen.push("Muñeco #" + (snowmen.length + 1));
            localStorage.setItem("snowmen", JSON.stringify(snowmen));

            // Guardar el ID recogido
            collectedIDs.push(id);
            localStorage.setItem("collectedSnowmenIDs", JSON.stringify(collectedIDs));

            const totalCollected = snowmen.length;
            
            let unlockedNow = false;
            let nextNeeded = 5 - (totalCollected % 5);

            // Lógica de desbloqueo (Solo se comprueba y se guarda el estado)
            if(totalCollected % 5 === 0){
                const collectibleToUnlock = firstCollectibleIndex + (totalCollected / 5) - 1;
                
                if(collectibleToUnlock <= maxCollectibleIndex) {
                    if(unlockCollectible(collectibleToUnlock)){
                        unlockedNow = true;
                        alert("❄️ ¡Muñecos recogidos! Un coleccionable se ha desbloqueado. Visita el Evento de Navidad para verlo.");
                    }
                } else {
                    alert("✅ ¡Muñeco recogido! Ya has desbloqueado todos los coleccionables disponibles.");
                }
            }
            
            if (!unlockedNow && totalCollected < maxCollectibleIndex * 5) {
                alert(`⛄ ¡Muñeco de nieve recogido! Faltan ${nextNeeded} para el próximo coleccionable.`);
            } else if (!unlockedNow) {
                 alert("⛄ ¡Muñeco de nieve recogido! (Ya has desbloqueado todos los premios)");
            }
        });
    });
}
    </script>

</body>
</html>
