<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Hundir la Flota</title>
<style>
    body {
        background: radial-gradient(circle at center, #002b5b, #000814);
        color: #fff;
        font-family: 'Segoe UI', sans-serif;
        text-align: center;
        margin: 0;
        padding: 0;
    }

    h1 {
        font-size: 2em;
        margin: 20px 0;
        color: #00bfff;
        text-shadow: 0 0 10px #00bfff;
    }

    .container {
        display: flex;
        justify-content: center;
        gap: 40px;
        flex-wrap: wrap;
        margin-bottom: 20px;
    }

    .board {
        display: grid;
        grid-template-columns: repeat(10, 30px);
        grid-template-rows: repeat(10, 30px);
        gap: 2px;
        background: #001d3d;
        border: 2px solid #00bfff;
        padding: 10px;
        border-radius: 10px;
        box-shadow: 0 0 20px rgba(0,191,255,0.5);
    }

    .cell {
        width: 30px;
        height: 30px;
        background: #003566;
        border-radius: 4px;
        cursor: pointer;
        transition: 0.2s;
    }

    .cell:hover {
        background: #00509d;
    }

    .hit {
        background: #ff4b4b !important;
        box-shadow: 0 0 10px #ff4b4b;
    }

    .miss {
        background: #555 !important;
    }

    .ship {
        background: #00bfff;
    }

    #message {
        font-size: 1.2em;
        margin-top: 10px;
    }

    button {
        background: #00bfff;
        border: none;
        padding: 10px 20px;
        border-radius: 8px;
        font-size: 1em;
        color: #000;
        cursor: pointer;
        margin-top: 20px;
        transition: 0.2s;
    }

    button:hover {
        background: #0096c7;
        transform: scale(1.05);
    }

    #menuBtn {
        position: absolute;
        top: 20px;
        left: 20px;
    }
</style>
</head>
<body>
    <h1>üö¢ Hundir la Flota</h1>

    <div class="container">
        <div>
            <h2>Tus Barcos</h2>
            <div id="player-board" class="board"></div>
        </div>
        <div>
            <h2>Tablero Enemigo</h2>
            <div id="ai-board" class="board"></div>
        </div>
    </div>

    <p id="message">¬°Dispara en el tablero enemigo!</p>

    <button id="restartBtn">üîÅ Reiniciar</button>
    <button id="menuBtn" onclick="window.location.href='menu.html'">üè† Volver al men√∫</button>

<script>
    const size = 10;
    const playerBoard = document.getElementById("player-board");
    const aiBoard = document.getElementById("ai-board");
    const message = document.getElementById("message");
    const restartBtn = document.getElementById("restartBtn");

    let playerShips = [];
    let aiShips = [];
    let aiAvailableShots = [];
    let gameOver = false;

    // Crear tablero
    function createBoard(boardElement, isPlayer = false) {
        boardElement.innerHTML = "";
        for (let i = 0; i < size * size; i++) {
            const cell = document.createElement("div");
            cell.classList.add("cell");
            cell.dataset.index = i;
            if (!isPlayer) {
                cell.addEventListener("click", () => playerShoot(cell));
            }
            boardElement.appendChild(cell);
        }
    }

    // Colocar barcos aleatoriamente
    function placeShipsRandomly() {
        const shipSizes = [5, 4, 3, 3, 2]; // tama√±os t√≠picos
        const board = Array(size * size).fill(false);
        const ships = [];

        for (let sizeShip of shipSizes) {
            let placed = false;
            while (!placed) {
                const direction = Math.random() < 0.5 ? "H" : "V";
                const start = Math.floor(Math.random() * size * size);
                const x = start % size;
                const y = Math.floor(start / size);

                let valid = true;
                const cells = [];

                for (let i = 0; i < sizeShip; i++) {
                    const nx = x + (direction === "H" ? i : 0);
                    const ny = y + (direction === "V" ? i : 0);
                    const index = ny * size + nx;

                    if (nx >= size || ny >= size || board[index]) {
                        valid = false;
                        break;
                    }
                    cells.push(index);
                }

                if (valid) {
                    cells.forEach(i => board[i] = true);
                    ships.push(cells);
                    placed = true;
                }
            }
        }
        return { ships, board };
    }

    // Inicializar partida
    function initGame() {
        gameOver = false;
        message.textContent = "¬°Dispara en el tablero enemigo!";
        const player = placeShipsRandomly();
        const ai = placeShipsRandomly();

        playerShips = player.ships;
        aiShips = ai.ships;
        aiAvailableShots = Array.from({ length: size * size }, (_, i) => i);

        createBoard(playerBoard, true);
        createBoard(aiBoard, false);

        // Mostrar barcos del jugador
        const playerCells = playerBoard.querySelectorAll(".cell");
        player.board.forEach((hasShip, i) => {
            if (hasShip) playerCells[i].classList.add("ship");
        });
    }

    // Disparo del jugador
    function playerShoot(cell) {
        if (gameOver || cell.classList.contains("hit") || cell.classList.contains("miss")) return;

        const index = parseInt(cell.dataset.index);
        let hit = false;

        for (let ship of aiShips) {
            if (ship.includes(index)) {
                hit = true;
                ship.splice(ship.indexOf(index), 1);
                cell.classList.add("hit");
                if (ship.length === 0) message.textContent = "¬°Hundiste un barco enemigo!";
                break;
            }
        }

        if (!hit) {
            cell.classList.add("miss");
            message.textContent = "¬°Fallaste! Turno del enemigo...";
            setTimeout(aiTurn, 700);
        } else {
            if (aiShips.every(s => s.length === 0)) {
                message.textContent = "üéâ ¬°Has ganado! Todos los barcos enemigos hundidos.";
                gameOver = true;
            }
        }
    }

    // Turno de la IA
    function aiTurn() {
        if (gameOver) return;
        const randomIndex = Math.floor(Math.random() * aiAvailableShots.length);
        const index = aiAvailableShots.splice(randomIndex, 1)[0];
        const playerCells = playerBoard.querySelectorAll(".cell");

        let hit = false;
        for (let ship of playerShips) {
            if (ship.includes(index)) {
                hit = true;
                ship.splice(ship.indexOf(index), 1);
                playerCells[index].classList.add("hit");
                break;
            }
        }

        if (!hit) {
            playerCells[index].classList.add("miss");
            message.textContent = "¬°Tu turno!";
        } else {
            if (playerShips.every(s => s.length === 0)) {
                message.textContent = "üí• ¬°Has perdido! Todos tus barcos fueron hundidos.";
                gameOver = true;
            } else {
                setTimeout(aiTurn, 700);
            }
        }
    }

    restartBtn.addEventListener("click", initGame);

    initGame();
</script>
</body>
</html>
