<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="utf-8">
<title>CSGO 2D — Ciudad táctica</title>
<style>
  html,body{margin:0;padding:0;overflow:hidden;background:#000;}
  canvas{display:block;}
  #hud{
    position:fixed;top:10px;left:10px;color:white;
    font-family:Arial, sans-serif;font-size:16px;
    background:rgba(0,0,0,0.5);padding:5px 10px;border-radius:8px;
  }
</style>
</head>
<body>
<div id="hud">Cargando...</div>
<canvas id="game"></canvas>
<script>
const canvas=document.getElementById("game");
const ctx=canvas.getContext("2d");
const hud=document.getElementById("hud");
let W,H;
function resize(){
  W=canvas.width=innerWidth;
  H=canvas.height=innerHeight;
}
resize(); addEventListener("resize",resize);

//-------------------------
// MAPA URBANO
//-------------------------
const TILE=60;
const MAP=[
"############################",
"#T#......................A.#",
"#.#....####.......####.....#",
"#.#....#..#.......#..#.....#",
"#.#....####.......####.....#",
"#.#.........................#",
"#.#..........####...........#",
"#.#..........#..#...........#",
"#.#..........####...........#",
"#..............B............#",
"#########............########",
"#C.........................CT#",
"############################"
];
const walls=[];
for(let y=0;y<MAP.length;y++){
  for(let x=0;x<MAP[y].length;x++){
    const c=MAP[y][x];
    if(c==="#") walls.push({x:x*TILE,y:y*TILE});
  }
}

//-------------------------
// ENTIDADES
//-------------------------
class Entity{
  constructor(x,y,color,team,name){
    this.x=x;this.y=y;
    this.color=color;
    this.team=team;
    this.dir=Math.random()*Math.PI*2;
    this.hp=100;
    this.name=name||"";
  }
  draw(){
    ctx.fillStyle=this.color;
    ctx.beginPath();
    ctx.arc(this.x,this.y,10,0,Math.PI*2);
    ctx.fill();
    ctx.font="12px Arial";
    ctx.fillStyle="#fff";
    ctx.fillText(this.name,this.x-10,this.y-15);
  }
}

function findChar(ch){
  for(let y=0;y<MAP.length;y++){
    for(let x=0;x<MAP[y].length;x++){
      if(MAP[y][x]===ch)
        return {x:x*TILE+TILE/2,y:y*TILE+TILE/2};
    }
  }
  return {x:100,y:100};
}

const playerPos=findChar("CT");
const player=new Entity(playerPos.x,playerPos.y,"#00aaff","CT","Tú");

const allies=[];const enemies=[];
const namesCT=["Alpha","Bravo","Charlie","Delta"];
const namesT=["Nash","Rico","Ivan","Sergei","Boris"];
for(let i=0;i<4;i++){
  allies.push(new Entity(playerPos.x+Math.random()*100-50,playerPos.y+Math.random()*100-50,"#00ff88","CT",namesCT[i]));
}
const tPos=findChar("T");
for(let i=0;i<5;i++){
  enemies.push(new Entity(tPos.x+Math.random()*100-50,tPos.y+Math.random()*100-50,"#ff4444","T",namesT[i]));
}

//-------------------------
// INPUT
//-------------------------
const keys={};
addEventListener("keydown",e=>keys[e.key.toLowerCase()]=true);
addEventListener("keyup",e=>keys[e.key.toLowerCase()]=false);

//-------------------------
// IA SIMPLE
//-------------------------
function updateAI(bot){
  const target=player;
  const dx=target.x-bot.x, dy=target.y-bot.y;
  const dist=Math.hypot(dx,dy);
  if(dist<350){
    bot.dir=Math.atan2(dy,dx);
    bot.x+=Math.cos(bot.dir)*1.2;
    bot.y+=Math.sin(bot.dir)*1.2;
  }else{
    bot.x+=Math.cos(bot.dir)*0.5;
    bot.y+=Math.sin(bot.dir)*0.5;
    if(Math.random()<0.01) bot.dir+=Math.random()-0.5;
  }
}

//-------------------------
// UPDATE
//-------------------------
let camX=0,camY=0;
function update(){
  // mover jugador
  let spd=3;
  if(keys["w"]) player.y-=spd;
  if(keys["s"]) player.y+=spd;
  if(keys["a"]) player.x-=spd;
  if(keys["d"]) player.x+=spd;

  // IA
  [...allies,...enemies].forEach(updateAI);

  // Cámara centrada
  camX=player.x-W/2;
  camY=player.y-H/2;

  draw();
  requestAnimationFrame(update);
}

//-------------------------
// DRAW
//-------------------------
function draw(){
  ctx.fillStyle="#202020";
  ctx.fillRect(0,0,W,H);
  ctx.save();
  ctx.translate(-camX,-camY);
  
  // mapa base
  for(let y=0;y<MAP.length;y++){
    for(let x=0;x<MAP[y].length;x++){
      const c=MAP[y][x];
      if(c==="#"){ctx.fillStyle="#333";ctx.fillRect(x*TILE,y*TILE,TILE,TILE);}
      else if(c==="A"||c==="B"){ctx.fillStyle="#555";ctx.fillRect(x*TILE,y*TILE,TILE,TILE);}
      else{ctx.fillStyle="#2a2a2a";ctx.fillRect(x*TILE,y*TILE,TILE,TILE);}
    }
  }

  // entidades
  [...allies,player,...enemies].forEach(e=>e.draw());
  ctx.restore();

  hud.innerHTML=`<b>CSGO 2D — Ciudad táctica</b><br>${player.name} HP:${player.hp}`;
}

// iniciar
hud.textContent="Listo. Iniciando...";
requestAnimationFrame(update);
</script>
</body>
</html>
