<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>CSGO 2D - Prototipo Mínimo (Partida Directa)</title>
    
    <script src="https://cdn.jsdelivr.net/npm/phaser@3.55.2/dist/phaser.min.js"></script>
    
    <style>
        body { 
            margin: 0; 
            padding: 0; 
            background: #111;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            overflow: hidden;
        }
        #game-container {
            border: 2px solid #555;
            box-shadow: 0 0 30px rgba(0, 0, 0, 0.7);
        }
    </style>
</head>
<body>
    <div id="game-container">
        </div>

    <script>
        //==============================================================
        // CONSTANTES GLOBALES MÍNIMAS
        //==============================================================
        const GAME_WIDTH = 1200;
        const GAME_HEIGHT = 800;
        const PLAYER_SPEED = 300;
        
        //==============================================================
        // CLASE ESCENA: JUEGO MÍNIMO
        //==============================================================
        class GameScene extends Phaser.Scene {
            constructor() {
                super('GameScene');
                this.player = null;
                this.keys = null;
            }

            create() {
                // 1. Configuración Visual Mínima
                this.cameras.main.setBackgroundColor('#34495e'); 
                this.add.rectangle(GAME_WIDTH / 2, GAME_HEIGHT / 2, GAME_WIDTH, GAME_HEIGHT, 0xbdc3c7);
                
                // 2. Creación del Personaje (Rectángulo Verde)
                // Lo creamos en el centro del mapa
                const spawnX = GAME_WIDTH / 2;
                const spawnY = GAME_HEIGHT / 2;
                
                this.player = this.add.rectangle(spawnX, spawnY, 32, 32, 0x2ecc71); 
                this.physics.add.existing(this.player); 
                
                this.player.body.setCollideWorldBounds(true); // Evita que salga del mapa
                this.player.body.setDrag(100);
                this.player.body.setCircle(16);
                this.player.setOrigin(0.5, 0.5);

                // 3. Configuración de la Cámara (Centrada en el jugador)
                this.cameras.main.startFollow(this.player, true, 0.1, 0.1);
                this.cameras.main.setZoom(1.5); // Zoom para mejor visibilidad
                
                // 4. Configuración de Controles
                this.keys = this.input.keyboard.addKeys({
                    up: Phaser.Input.Keyboard.KeyCodes.W,
                    down: Phaser.Input.Keyboard.KeyCodes.S,
                    left: Phaser.Input.Keyboard.KeyCodes.A,
                    right: Phaser.Input.Keyboard.KeyCodes.D
                });
                
                // Mensaje de ayuda (fijo en la pantalla)
                this.add.text(GAME_WIDTH / 2, GAME_HEIGHT - 50, 'Usa W/A/S/D para moverte.', {
                    fontSize: '24px',
                    fill: '#f1c40f'
                }).setOrigin(0.5).setScrollFactor(0); 
            }

            // --- Bucle Principal de Actualización ---
            update(time, delta) {
                this.handleMovement();
            }

            handleMovement() {
                this.player.body.setVelocity(0);
                let moving = false;
                
                // Movimiento básico W/A/S/D
                if (this.keys.up.isDown) { this.player.body.setVelocityY(-PLAYER_SPEED); moving = true; } 
                else if (this.keys.down.isDown) { this.player.body.setVelocityY(PLAYER_SPEED); moving = true; }
                if (this.keys.left.isDown) { this.player.body.setVelocityX(-PLAYER_SPEED); moving = true; } 
                else if (this.keys.right.isDown) { this.player.body.setVelocityX(PLAYER_SPEED); moving = true; }

                // Normalizar velocidad para movimiento diagonal constante
                if (moving) { 
                    this.player.body.velocity.normalize().scale(PLAYER_SPEED); 
                }
            }
        }


        //==============================================================
        // INICIALIZACIÓN DE PHASER (SIN MENÚ)
        //==============================================================
        const gameConfig = {
            type: Phaser.AUTO,
            width: GAME_WIDTH,
            height: GAME_HEIGHT,
            physics: {
                default: 'arcade',
                arcade: {
                    gravity: { y: 0 } 
                    // debug: true // Descomenta esta línea para ver la hitbox (círculo)
                }
            },
            scene: [GameScene], // Solo cargamos la escena de juego
            parent: 'game-container'
        };

        const game = new Phaser.Game(gameConfig);
    </script>
</body>
</html>
