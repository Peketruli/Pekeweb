<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Solitario</title>
<style>
body {
    margin: 0;
    background-color: #0b3d0b;
    color: white;
    font-family: Arial, sans-serif;
    overflow: hidden;
}
#top-bar {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 10px 20px;
    background: #062906;
    border-bottom: 2px solid #1a501a;
}
#top-bar button {
    background-color: #333;
    color: white;
    border: none;
    padding: 8px 16px;
    border-radius: 8px;
    cursor: pointer;
}
#top-bar button:hover { background-color: #555; }

#game {
    display: flex;
    flex-direction: column;
    align-items: center;
    height: calc(100vh - 60px);
    padding-top: 20px;
}

#board {
    display: flex;
    flex-direction: column;
    align-items: center;
}

#top-area {
    display: flex;
    justify-content: space-between;
    width: 90%;
    margin-bottom: 40px;
}

#deck, #waste, #foundations {
    display: flex;
    align-items: center;
    gap: 10px;
}

.slot {
    width: 90px;
    height: 130px;
    background-color: rgba(255,255,255,0.1);
    border: 2px dashed rgba(255,255,255,0.2);
    border-radius: 8px;
    display: flex;
    align-items: center;
    justify-content: center;
    position: relative;
}

.card {
    width: 90px;
    height: 130px;
    background-color: white;
    border-radius: 8px;
    color: black;
    text-align: center;
    line-height: 130px;
    font-weight: bold;
    font-size: 24px;
    position: absolute;
    left: 0;
    cursor: pointer;
    user-select: none;
    transition: transform 0.2s;
}
.card.red { color: red; }
.card.back {
    background-color: #1a501a;
    border: 2px solid #093109;
    color: transparent;
}

#tableau {
    display: flex;
    justify-content: center;
    gap: 10px;
    width: 100%;
}

.column {
    width: 90px;
    height: 500px;
    position: relative;
    background-color: rgba(255,255,255,0.1);
    border-radius: 8px;
}
</style>
</head>
<body>
    <div id="top-bar">
        <button onclick="window.location.href='menu.html'">← Volver</button>
        <h2>Solitario</h2>
        <button onclick="iniciarJuego()">Reiniciar</button>
    </div>

    <div id="game">
        <div id="board">
            <div id="top-area">
                <div id="deck-area">
                    <div id="deck" class="slot" onclick="robarCarta()"></div>
                    <div id="waste" class="slot"></div>
                </div>
                <div id="foundations">
                    <div class="slot" id="f0"></div>
                    <div class="slot" id="f1"></div>
                    <div class="slot" id="f2"></div>
                    <div class="slot" id="f3"></div>
                </div>
            </div>
            <div id="tableau"></div>
        </div>
    </div>

<script>
const palos = ['♠', '♥', '♦', '♣'];
let mazo = [], descarte = [];
let tableau = [[],[],[],[],[],[],[]];
let fundaciones = [[],[],[],[]];

function crearMazo() {
    mazo = [];
    for (let palo of palos) {
        for (let valor = 1; valor <= 13; valor++) {
            let nombre = valor;
            if (valor === 1) nombre = 'A';
            else if (valor === 11) nombre = 'J';
            else if (valor === 12) nombre = 'Q';
            else if (valor === 13) nombre = 'K';
            mazo.push({ valor, palo, color: (palo === '♥' || palo === '♦') ? 'red' : 'black', visible: false });
        }
    }
}

function barajar() {
    for (let i = mazo.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [mazo[i], mazo[j]] = [mazo[j], mazo[i]];
    }
}

function repartirCartas() {
    tableau = [[],[],[],[],[],[],[]];
    for (let i = 0; i < 7; i++) {
        for (let j = 0; j <= i; j++) {
            const carta = mazo.pop();
            carta.visible = (j === i);
            tableau[i].push(carta);
        }
    }
    render();
}

function robarCarta() {
    if (mazo.length === 0) {
        // Reiniciar descarte al mazo
        mazo = descarte.reverse().map(c => ({...c, visible:false}));
        descarte = [];
    } else {
        const carta = mazo.pop();
        carta.visible = true;
        descarte.push(carta);
    }
    render();
}

function render() {
    // Render del mazo
    const deckDiv = document.getElementById('deck');
    deckDiv.innerHTML = '';
    if (mazo.length > 0) {
        const back = document.createElement('div');
        back.className = 'card back';
        deckDiv.appendChild(back);
    }

    // Render descarte
    const wasteDiv = document.getElementById('waste');
    wasteDiv.innerHTML = '';
    if (descarte.length > 0) {
        const carta = descarte[descarte.length - 1];
        const div = crearCartaDiv(carta);
        wasteDiv.appendChild(div);
    }

    // Render fundaciones
    for (let i = 0; i < 4; i++) {
        const fDiv = document.getElementById('f'+i);
        fDiv.innerHTML = '';
        if (fundaciones[i].length > 0) {
            fDiv.appendChild(crearCartaDiv(fundaciones[i][fundaciones[i].length - 1]));
        }
    }

    // Render tableau
    const tabla = document.getElementById('tableau');
    tabla.innerHTML = '';
    for (let i = 0; i < 7; i++) {
        const col = document.createElement('div');
        col.className = 'column';
        let offset = 0;
        for (const carta of tableau[i]) {
            const div = crearCartaDiv(carta);
            div.style.top = offset + 'px';
            col.appendChild(div);
            offset += 25;
        }
        tabla.appendChild(col);
    }
}

function crearCartaDiv(carta) {
    const div = document.createElement('div');
    div.className = 'card ' + (carta.visible ? (carta.color === 'red' ? 'red' : '') : 'back');
    if (carta.visible) div.textContent = (carta.valor === 1 ? 'A' : carta.valor === 11 ? 'J' : carta.valor === 12 ? 'Q' : carta.valor === 13 ? 'K' : carta.valor) + carta.palo;
    return div;
}

function iniciarJuego() {
    crearMazo();
    barajar();
    descarte = [];
    fundaciones = [[],[],[],[]];
    repartirCartas();
}

window.onload = iniciarJuego;
</script>
</body>
</html>
