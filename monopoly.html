<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Monopoly Cl치sico</title>
<style>
  body {
    margin: 0;
    background: #165a2b;
    color: white;
    font-family: sans-serif;
    display: flex;
    justify-content: center;
    align-items: center;
    flex-direction: column;
  }
  #game {
    display: flex;
    flex-direction: row;
    align-items: center;
    gap: 15px;
  }
  #hands {
    display: flex;
    flex-direction: column;
    gap: 20px;
    width: 180px;
  }
  .hand {
    border-radius: 8px;
    padding: 8px;
    min-height: 200px;
    display: flex;
    flex-direction: column;
    gap: 8px;
    transition: all 0.3s ease;
  }
  #playerHand { background: #093; }
  #aiHand { background: #345; }
  .hand h3 { margin: 0 0 5px 0; text-align: center; }
  .card {
    background: #fff;
    color: #000;
    padding: 4px;
    border-radius: 6px;
    font-size: 12px;
    text-align: center;
    cursor: pointer;
    position: relative;
    box-shadow: 0 0 5px #000;
  }
  .tooltip {
    position: absolute;
    bottom: 90px;
    left: 0;
    background: #333;
    color: white;
    padding: 5px;
    border-radius: 6px;
    font-size: 11px;
    display: none;
    width: 180px;
    z-index: 5;
  }
  .card:hover .tooltip {
    display: block;
  }
  canvas {
    background: #fafafa;
    border: 6px solid #000;
  }
  #hud {
    display: flex;
    justify-content: space-between;
    width: 700px;
    margin-top: 10px;
  }
  #message {
    margin-top: 8px;
    min-height: 24px;
  }
  #draw-card {
    position: absolute;
    top: 300px;
    left: 50%;
    transform: translateX(-50%);
    width: 120px;
    height: 160px;
    background: orange;
    color: black;
    font-weight: bold;
    display: flex;
    justify-content: center;
    align-items: center;
    border-radius: 10px;
    opacity: 0;
    transition: transform 0.4s ease, opacity 0.4s ease;
  }
</style>
</head>
<body>
<h2>游 Monopoly Cl치sico</h2>
<div id="hud">
  <div id="money">游눯 Jugador: 1500</div>
  <button id="roll">Tirar Dados</button>
  <div id="turn">Turno: Jugador</div>
</div>
<div id="game">
  <div id="hands">
    <div id="playerHand" class="hand"><h3>游븴 T칰</h3></div>
    <div id="aiHand" class="hand"><h3>游뱄 IA</h3></div>
  </div>
  <canvas id="board" width="700" height="700"></canvas>
</div>
<div id="message"></div>
<div id="draw-card">Carta</div>

<script>
const canvas = document.getElementById("board");
const ctx = canvas.getContext("2d");
const rollBtn = document.getElementById("roll");
const msg = document.getElementById("message");
const drawCardEl = document.getElementById("draw-card");
const playerHandEl = document.getElementById("playerHand");
const aiHandEl = document.getElementById("aiHand");

let turn = "player";
let playerMoney = 1500, aiMoney = 1500;
let playerPos = 0, aiPos = 0;
let playerProps = [], aiProps = [];

const boardSize = 700;
const corner = 100, cell = 60;

const propertyData = [
  {name:"Salida", type:"corner"},
  {name:"Mediterr치neo", price:60, color:"brown"},
  {name:"Arca Comunal", type:"arca"},
  {name:"Baltic Avenue", price:60, color:"brown"},
  {name:"Impuesto", type:"tax"},
  {name:"Estaci칩n Reading", price:200, type:"station"},
  {name:"Oriental Avenue", price:100, color:"lightblue"},
  {name:"Suerte", type:"suerte"},
  {name:"Vermont Avenue", price:100, color:"lightblue"},
  {name:"Connecticut Avenue", price:120, color:"lightblue"},
  {name:"C치rcel", type:"corner"},
  {name:"St. Charles Place", price:140, color:"pink"},
  {name:"Compa침칤a El칠ctrica", price:150, type:"company"},
  {name:"States Avenue", price:140, color:"pink"},
  {name:"Virginia Avenue", price:160, color:"pink"},
  {name:"Estaci칩n Pennsylvania", price:200, type:"station"},
  {name:"St. James Place", price:180, color:"orange"},
  {name:"Arca Comunal", type:"arca"},
  {name:"Tennessee Avenue", price:180, color:"orange"},
  {name:"New York Avenue", price:200, color:"orange"},
  {name:"Parking", type:"corner"},
  {name:"Kentucky Avenue", price:220, color:"red"},
  {name:"Suerte", type:"suerte"},
  {name:"Indiana Avenue", price:220, color:"red"},
  {name:"Illinois Avenue", price:240, color:"red"},
  {name:"Estaci칩n B&O", price:200, type:"station"},
  {name:"Atlantic Avenue", price:260, color:"yellow"},
  {name:"Ventnor Avenue", price:260, color:"yellow"},
  {name:"Compa침칤a Agua", price:150, type:"company"},
  {name:"Marvin Gardens", price:280, color:"yellow"},
  {name:"Ve a la C치rcel", type:"corner"},
  {name:"Pacific Avenue", price:300, color:"green"},
  {name:"North Carolina Avenue", price:300, color:"green"},
  {name:"Arca Comunal", type:"arca"},
  {name:"Pennsylvania Avenue", price:320, color:"green"},
  {name:"Estaci칩n Short Line", price:200, type:"station"},
  {name:"Suerte", type:"suerte"},
  {name:"Park Place", price:350, color:"darkblue"},
  {name:"Impuesto Lujo", type:"tax"},
  {name:"Boardwalk", price:400, color:"darkblue"}
];

function drawBoard(){
  ctx.clearRect(0,0,boardSize,boardSize);
  ctx.strokeStyle="#000"; ctx.lineWidth=2;
  ctx.strokeRect(0,0,boardSize,boardSize);
  ctx.fillStyle="#fff";
  ctx.font="11px sans-serif";

  for(let i=0;i<11;i++){
    if(i<10) ctx.strokeRect(boardSize-corner-(i*cell),boardSize-corner,cell,corner); // bottom
    if(i<10) ctx.strokeRect(0,boardSize-corner-(i*cell),corner,cell); // left
    if(i<10) ctx.strokeRect(corner+(i*cell),0,cell,corner); // top
    if(i<10) ctx.strokeRect(boardSize-corner,corner+(i*cell),corner,cell); // right
  }

  // esquinas
  ctx.strokeRect(0,0,corner,corner);
  ctx.strokeRect(boardSize-corner,0,corner,corner);
  ctx.strokeRect(0,boardSize-corner,corner,corner);
  ctx.strokeRect(boardSize-corner,boardSize-corner,corner,corner);
  ctx.fillStyle="#000";
  ctx.fillText("Salida",boardSize-80,boardSize-10);
  ctx.fillText("C치rcel",10,boardSize-10);
  ctx.fillText("Parking",10,20);
  ctx.fillText("Ve a la C치rcel",boardSize-90,20);
}

function showMessage(t){ msg.textContent=t; }

function updateHUD(){
  document.getElementById("money").textContent = `游눯 T칰: ${playerMoney} | 游뱄 IA: ${aiMoney}`;
  document.getElementById("turn").textContent = `Turno: ${turn==="player"?"T칰":"IA"}`;
}

function animateCard(text){
  drawCardEl.textContent = text;
  drawCardEl.style.opacity="1";
  drawCardEl.style.transform="translateY(-30px)";
  setTimeout(()=>{drawCardEl.style.opacity="0";drawCardEl.style.transform="";},2000);
}

function addCardTo(handEl, card){
  const div = document.createElement("div");
  div.className="card";
  div.innerHTML=`<b>${card.name}</b>${card.price?`<br>$${card.price}`:""}`;
  if(card.color) div.style.borderTop=`15px solid ${card.color}`;
  const tip=document.createElement("div");
  tip.className="tooltip";
  if(card.type==="property") tip.innerHTML=card.info;
  else if(card.type==="card") tip.innerHTML=`<b>${card.name}</b><br>${card.desc}`;
  div.appendChild(tip);
  handEl.appendChild(div);
  div.style.opacity=0; div.style.transform="translateX(-20px)";
  setTimeout(()=>{div.style.transition="0.3s";div.style.opacity=1;div.style.transform="translateX(0)";},50);
}

function rentForStation(ownerProps){
  let count = ownerProps.filter(p=>p.type==="station").length;
  if(count===1)return 25;
  if(count===2)return 50;
  if(count===3)return 100;
  if(count>=4)return 200;
  return 25;
}

function rollDice(){
  let d1 = Math.floor(Math.random()*6)+1;
  let d2 = Math.floor(Math.random()*6)+1;
  return [d1,d2];
}

function handleTile(player,pos){
  const tile = propertyData[pos];
  if(tile.type==="suerte"||tile.type==="arca"){
    animateCard(tile.type==="suerte"?"Suerte":"Arca");
    return;
  }
  if(tile.price && !tile.owner){
    if(player==="player"){
      if(confirm(`쮺omprar ${tile.name} por $${tile.price}?`)){
        if(playerMoney>=tile.price){
          playerMoney-=tile.price;
          tile.owner="player";
          const info = tile.type==="station"?
            `Renta: 1=${25}, 2=${50}, 3=${100}, 4=${200}`:
            tile.type==="company"?
            `Renta: 4x o 10x el valor de los dados`:
            `Renta base: $${Math.floor(tile.price*0.1)} por casa`;
          addCardTo(playerHandEl,{...tile,type:"property",info});
          playerProps.push(tile);
          showMessage(`Compraste ${tile.name}`);
        }
      }
    } else {
      if(aiMoney>=tile.price){
        aiMoney-=tile.price;
        tile.owner="ai";
        const info = tile.type==="station"?
            `Renta: 1=${25}, 2=${50}, 3=${100}, 4=${200}`:
            tile.type==="company"?
            `Renta: 4x o 10x el valor de los dados`:
            `Renta base: $${Math.floor(tile.price*0.1)} por casa`;
        addCardTo(aiHandEl,{...tile,type:"property",info});
        aiProps.push(tile);
        showMessage(`IA compr칩 ${tile.name}`);
      }
    }
  } else if(tile.owner && tile.owner!==player){
    let rent = 0;
    if(tile.type==="station") rent = rentForStation(tile.owner==="player"?playerProps:aiProps);
    else if(tile.type==="company") rent = (Math.floor(Math.random()*6)+1)*4; // simplificado
    else rent = Math.floor(tile.price*0.1);
    if(player==="player"){playerMoney-=rent;aiMoney+=rent;}
    else {aiMoney-=rent;playerMoney+=rent;}
    showMessage(`${player==="player"?"Pagas":"Recibes"} $${rent} por ${tile.name}`);
  }
  updateHUD();
}

function nextTurn(){
  turn = turn==="player"?"ai":"player";
  updateHUD();
  if(turn==="ai") setTimeout(aiMove,800);
}

function aiMove(){
  const [d1,d2]=rollDice();
  let total=d1+d2;
  aiPos=(aiPos+total)%40;
  handleTile("ai",aiPos);
  if(d1===d2) setTimeout(aiMove,1200);
  else nextTurn();
}

rollBtn.onclick=()=>{
  const [d1,d2]=rollDice();
  let total=d1+d2;
  playerPos=(playerPos+total)%40;
  handleTile("player",playerPos);
  if(d1!==d2) nextTurn();
};

drawBoard();
updateHUD();
showMessage("Tu turno. Tira los dados.");
</script>
</body>
</html>
