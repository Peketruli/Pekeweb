<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Trailer — PekeOS</title>
  <style>
    :root{--bg:#0c0b16;--accent:#3be7c8;--accent-2:#ffd166;--muted:rgba(255,255,255,0.08)}
    html,body{height:100%;margin:0;font-family:Inter, system-ui, -apple-system, 'Segoe UI', Roboto, 'Helvetica Neue', Arial}
    .stage{background:radial-gradient(ellipse at 20% 10%, rgba(59,231,200,0.06), transparent 10%), linear-gradient(180deg,#0b0b14 0%, #0f0c1a 100%);height:100vh;display:flex;align-items:center;justify-content:center;overflow:hidden;position:relative;color:white}

    /* Stars */
    .stars{position:absolute;inset:0;overflow:hidden;pointer-events:none}
    .star{position:absolute;width:2px;height:2px;border-radius:50%;background:linear-gradient(90deg,#fff,#ffd);opacity:0.9;transform:translateZ(0)}

    /* Center card */
    .card{width:min(1100px,95%);height:min(600px,86%);background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));border-radius:18px;box-shadow:0 20px 60px rgba(0,0,0,0.6);display:flex;gap:24px;padding:28px;align-items:center;justify-content:center;position:relative}

    /* Left: logo + text */
    .left{flex:1;display:flex;flex-direction:column;gap:12px;padding:18px}
    .logo-wrap{display:flex;align-items:center;gap:14px}
    .logo{width:110px;height:110px;border-radius:22px;background:linear-gradient(135deg,var(--accent),#26c5b3);display:flex;align-items:center;justify-content:center;box-shadow:0 8px 30px rgba(59,231,200,0.08);transform:scale(0);}
    .logo svg{width:64px;height:64px}

    .title{font-size:48px;line-height:1;letter-spacing:-1px;opacity:0;transform:translateY(10px)}
    .subtitle{font-size:20px;color:rgba(255,255,255,0.85);opacity:0;transform:translateY(10px)}

    /* Right: character */
    .right{width:380px;height:380px;display:flex;align-items:center;justify-content:center;position:relative}
    .char{width:320px;height:320px;transform:translateY(40px) scale(0.9);opacity:0}

    /* CTA bar */
    .cta{position:absolute;bottom:18px;left:50%;transform:translateX(-50%);display:flex;gap:12px;align-items:center;padding:10px 14px;border-radius:999px;background:rgba(255,255,255,0.03);backdrop-filter:blur(6px)}
    .date{font-weight:700}
    .btn{padding:10px 14px;border-radius:8px;background:linear-gradient(90deg,var(--accent-2),#ffb05a);color:#111;font-weight:700;border:none;cursor:pointer}

    /* Scenes timeline */
    .fade-in{animation:fadeIn .6s ease forwards}
    @keyframes fadeIn{to{opacity:1;transform:none}}

    /* small screens */
    @media (max-width:880px){
      .card{flex-direction:column-reverse;height:auto;padding:18px}
      .right{width:100%;height:320px}
      .left{width:100%}
      .title{font-size:34px}
    }

    /* cinematic letterboxing for trailer */
    .bar-top,.bar-bottom{position:absolute;left:0;right:0;height:8vh;background:#000;z-index:40;pointer-events:none}
    .bar-top{top:-10vh}
    .bar-bottom{bottom:-10vh}

    /* progress */
    .progress{position:absolute;bottom:0;left:0;right:0;height:4px;background:rgba(255,255,255,0.06)}
    .progress > i{display:block;height:100%;width:0%;background:linear-gradient(90deg,var(--accent),var(--accent-2));transition:width linear}

    /* small helper */
    .muted{color:rgba(255,255,255,0.6);font-size:13px}
  </style>
</head>
<body>
  <div class="stage" role="application" aria-label="Trailer PekeOS">
    <div class="stars" aria-hidden="true"></div>

    <div class="card" id="card">
      <div class="left">
        <div class="logo-wrap">
          <div class="logo" id="logo" aria-hidden="true">
            <!-- simple SVG logo -->
            <svg viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
              <defs>
                <linearGradient id="g" x1="0" x2="1"><stop offset="0" stop-color="#3be7c8"/><stop offset="1" stop-color="#28c1b0"/></linearGradient>
              </defs>
              <rect x="6" y="6" width="88" height="88" rx="18" fill="url(#g)" />
              <circle cx="36" cy="40" r="7" fill="#072026" />
              <circle cx="64" cy="40" r="7" fill="#072026" />
              <path d="M34 62c6 6 26 6 32 0" stroke="#072026" stroke-width="6" stroke-linecap="round" fill="none" />
            </svg>
          </div>
          <div>
            <div class="title" id="title">PekeOS</div>
            <div class="subtitle" id="subtitle">Un sistema operativo pequeñito. Muy grande en diversión.</div>
          </div>
        </div>

        <div style="height:18px"></div>
        <div class="muted" id="muted">Trailer oficial • Peke Labs</div>
      </div>

      <div class="right">
        <!-- simple character as inline SVG -->
        <div class="char" id="char" aria-hidden="true">
          <svg viewBox="0 0 200 200" width="320" height="320" xmlns="http://www.w3.org/2000/svg">
            <defs>
              <linearGradient id="c1" x1="0" x2="1"><stop offset="0" stop-color="#ffd59a"/><stop offset="1" stop-color="#ffc07a"/></linearGradient>
            </defs>
            <g transform="translate(0,0)">
              <ellipse cx="100" cy="110" rx="70" ry="72" fill="url(#c1)" />
              <circle cx="75" cy="88" r="10" fill="#2b2b2b" />
              <circle cx="125" cy="88" r="10" fill="#2b2b2b" />
              <path d="M70 125c10 10 30 10 50 0" stroke="#2b2b2b" stroke-width="6" stroke-linecap="round" fill="none" />
              <path d="M52 40c8-10 30-18 56-18s48 6 56 18" stroke="#ffb58a" stroke-width="6" stroke-linecap="round" fill="none" opacity="0.35"/>
            </g>
          </svg>
        </div>
      </div>

      <div class="cta" role="status" aria-live="polite">
        <div class="muted">Lanzamiento: </div>
        <div class="date" id="launchDate">calculando...</div>
        <button class="btn" id="skip">Saltar</button>
      </div>

      <div class="progress" aria-hidden="true" style="left:0;right:0;bottom:0"><i id="progressBar"></i></div>
    </div>

    <!-- cinematic bars -->
    <div class="bar-top" id="barTop"></div>
    <div class="bar-bottom" id="barBottom"></div>
  </div>

  <script>
    /* small helper: create stars */
    function makeStars(){
      const s = document.querySelector('.stars');
      const w = window.innerWidth; const h = window.innerHeight;
      for(let i=0;i<120;i++){
        const el = document.createElement('div'); el.className='star';
        const left = Math.random()*100; const top = Math.random()*100;
        const size = Math.random()*2+1; el.style.width = size+'px'; el.style.height = size+'px';
        el.style.left = left+'%'; el.style.top = top+'%'; el.style.opacity = Math.random();
        const animDur = 8+Math.random()*12;
        el.style.transition = `transform ${animDur}s linear`;
        s.appendChild(el);
      }
    }

    makeStars();

    /* timeline: sequence of animations for a trailer */
    const logo = document.getElementById('logo');
    const title = document.getElementById('title');
    const subtitle = document.getElementById('subtitle');
    const char = document.getElementById('char');
    const progressBar = document.getElementById('progressBar');
    const skipBtn = document.getElementById('skip');

    // compute next Thursday from current date
    function nextThursday(from=new Date()){
      const day = from.getDay(); // 0=Sun, 4=Thu
      const target = 4;
      let diff = target - day;
      if(diff <= 0) diff += 7; // next week if today is Thu or later
      const d = new Date(from);
      d.setDate(from.getDate() + diff);
      return d;
    }

    function formatDate(d){
      const opts = {weekday:'short', year:'numeric', month:'short', day:'numeric'};
      return d.toLocaleDateString('es-ES', opts);
    }

    const launch = nextThursday(new Date());
    document.getElementById('launchDate').textContent = formatDate(launch);

    // trailer timeline (in seconds)
    const timeline = [
      {t:0,fn:() => { // open cinematic bars
        document.getElementById('barTop').animate([{top:'-10vh'},{top:'0'}],{duration:700,easing:'cubic-bezier(.2,.9,.2,1'),fill:'forwards'})
        document.getElementById('barBottom').animate([{bottom:'-10vh'},{bottom:'0'}],{duration:700,easing:'cubic-bezier(.2,.9,.2,1'),fill:'forwards'})
      }},
      {t:0.6,fn:() => { logo.animate([{transform:'scale(0)'},{transform:'scale(1.03)'},{transform:'scale(1)'}],{duration:800,easing:'cubic-bezier(.2,.9,.2,1'),fill:'forwards'}); }
      },
      {t:1.2,fn:() => { title.classList.add('fade-in'); title.animate([{opacity:0,transform:'translateY(10px)'},{opacity:1,transform:'translateY(0)'}],{duration:600,fill:'forwards'}); }
      },
      {t:1.8,fn:() => { subtitle.classList.add('fade-in'); subtitle.animate([{opacity:0,transform:'translateY(12px)'},{opacity:1,transform:'translateY(0)'}],{duration:600,fill:'forwards'}); }
      },
      {t:2.6,fn:() => { // character entrance bounce
        char.style.opacity=1; char.animate([{transform:'translateY(40px) scale(0.9)'},{transform:'translateY(0px) scale(1.04)'},{transform:'translateY(6px) scale(1)'}],{duration:700,easing:'cubic-bezier(.2,.9,.2,1'),fill:'forwards'})
      }},
      {t:3.6,fn:() => { // small pulse on logo + subtitle change
        logo.animate([{transform:'scale(1)'},{transform:'scale(1.06)'},{transform:'scale(1)'}],{duration:700,iterations:2})
      }},
      {t:4.4,fn:() => { subtitle.textContent = 'Crea, juega y comparte — ligero y rápido.'; subtitle.animate([{opacity:0,transform:'translateY(6px)'},{opacity:1,transform:'translateY(0)'}],{duration:600,fill:'forwards'}) }},
      {t:6.0,fn:() => { // dramatic 'COMING' overlay
        const coming = document.createElement('div'); coming.style.position='absolute'; coming.style.inset='0'; coming.style.display='flex'; coming.style.alignItems='center'; coming.style.justifyContent='center'; coming.style.pointerEvents='none'; coming.innerHTML = `<div style="font-size:64px;font-weight:800;letter-spacing:2px;text-align:center;line-height:1">¡PekeOS<br>DESPEGANDO!</div>`;
        coming.style.opacity=0; coming.style.color='white'; coming.style.textShadow='0 8px 40px rgba(0,0,0,0.6)'; document.querySelector('.card').appendChild(coming);
        coming.animate([{opacity:0,transform:'scale(0.96) translateY(20px)'},{opacity:1,transform:'scale(1) translateY(0)'}],{duration:800,fill:'forwards'})
      }},
      {t:8.2,fn:() => { // final reveal
        document.querySelector('.card').animate([{filter:'none'},{filter:'contrast(1.2) saturate(1.1)'}],{duration:700,fill:'forwards'});
        document.getElementById('muted').textContent = 'Disponible el: ' + formatDate(launch);
      }},
      {t:9.2,fn:() => { // close cinematic bars
        document.getElementById('barTop').animate([{top:'0'},{top:'-10vh'}],{duration:700,easing:'cubic-bezier(.2,.9,.2,1'),fill:'forwards'})
        document.getElementById('barBottom').animate([{bottom:'0'},{bottom:'-10vh'}],{duration:700,easing:'cubic-bezier(.2,.9,.2,1'),fill:'forwards'})
      }},
    ];

    // control playback + progress
    let start = performance.now();
    const duration = 10.0; // seconds
    function tick(now){
      const elapsed = (now - start)/1000;
      const pct = Math.min(100, (elapsed/duration)*100);
      progressBar.style.width = pct+'%';
      // fire timeline events
      timeline.forEach(ev=>{ if(!ev.done && elapsed >= ev.t){ try{ ev.fn() }catch(e){} ev.done=true }});
      if(elapsed < duration) requestAnimationFrame(tick);
    }

    requestAnimationFrame(tick);

    // skip button behavior — instantly go to final state
    skipBtn.addEventListener('click', ()=>{
      timeline.forEach(ev=>{ if(!ev.done){ try{ ev.fn() }catch(e){} ev.done=true }});
      progressBar.style.width = '100%';
      document.getElementById('muted').textContent = 'Disponible el: ' + formatDate(launch);
    });

    // accessibility: allow space to skip
    window.addEventListener('keydown', (e)=>{ if(e.code==='Space'){ e.preventDefault(); skipBtn.click(); }});

    // micro-interactivity: small floating motion for stars
    setInterval(()=>{
      document.querySelectorAll('.star').forEach(s=>{
        const dx = (Math.random()-0.5)*6; const dy=(Math.random()-0.5)*6;
        s.animate([{transform:'translate(0,0)'},{transform:`translate(${dx}px,${dy}px)`}],{duration:2000+Math.random()*4000,fill:'forwards'});
      });
    },1200);

    // make the trailer export-friendly: press 'E' to create a short GIF-like capture sequence (uses canvas capture)
    // NOTE: this is a naive recorder for demo; for production use a dedicated screen recorder or ffmpeg.
    let rec;
    window.addEventListener('keydown', async (e)=>{
      if(e.key.toLowerCase()==='e'){
        try{
          const stream = document.querySelector('.stage').captureStream(30);
          const mime = 'video/webm';
          const mediaRecorder = new MediaRecorder(stream, {mimeType:mime});
          const parts = [];
          mediaRecorder.ondataavailable = ev=>parts.push(ev.data);
          mediaRecorder.onstop = ()=>{
            const blob = new Blob(parts, {type:mime});
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a'); a.href=url; a.download='pekeos-trailer.webm'; a.click();
            URL.revokeObjectURL(url);
          };
          mediaRecorder.start();
          setTimeout(()=>mediaRecorder.stop(), 10000); // 10s capture (same as trailer)
        }catch(err){ alert('La grabación no es compatible en tu navegador.'); }
      }
    });

    // small: allow clicking card to replay
    document.getElementById('card').addEventListener('click', ()=>{
      // reset timeline
      timeline.forEach(ev=>ev.done=false);
      start = performance.now();
      requestAnimationFrame(tick);
      // reset elements
      logo.style.transform='scale(0)'; title.style.opacity=0; subtitle.style.opacity=0; char.style.opacity=0; progressBar.style.width='0%';
    });

  </script>
</body>
</html>
