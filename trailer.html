<!doctype html>
<html lang="es">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>PekeOS — Trailer sincronizado (monitor B, duración libre)</title>
<style>
  :root{
    --bezel:#111216; --monitor:#071018; --accent:#00f6ff; --glass:rgba(255,255,255,0.04);
  }
  *{box-sizing:border-box}
  html,body{height:100%;margin:0;background:linear-gradient(180deg,#05060a,#0b0d10);font-family:Inter,system-ui,Arial,sans-serif;color:#fff;display:flex;align-items:center;justify-content:center}
  /* Monitor frame (retro curvado) */
  .monitor-frame{ width:1000px; max-width:95vw; aspect-ratio:16/9; border-radius:28px; padding:26px; background:linear-gradient(180deg,var(--bezel),#0b0b0d); box-shadow:0 45px 120px rgba(0,0,0,0.75), inset 0 6px 20px rgba(255,255,255,0.02); position:relative; display:flex; align-items:center; justify-content:center; }
  .stand{ position:absolute; bottom:-48px; left:50%; transform:translateX(-50%); width:260px; height:48px; background:linear-gradient(180deg,#0c0c0d,#0a0a0b); border-radius:8px; box-shadow:0 20px 40px rgba(0,0,0,0.6); }

  /* inner screen */
  .screen{ width:100%; height:100%; border-radius:12px; overflow:hidden; background:var(--monitor); display:flex; align-items:center; justify-content:center; position:relative; }
  /* overlay for cinematic fade */
  #fadeOverlay{ position:absolute; inset:0; background:#000; pointer-events:none; opacity:1; transition:opacity 700ms ease; z-index:60; }
  #fadeOverlay.hidden{ opacity:0; }

  /* CRT scan overlay (for power off) */
  .crt-scan{ position:absolute; inset:0; pointer-events:none; opacity:0; mix-blend-mode:screen; background:linear-gradient(180deg, rgba(255,255,255,0.03) 0%, rgba(255,255,255,0.0) 50%, rgba(255,255,255,0.03) 100%); transition:opacity .15s; z-index:55; }
  .pc-crt .crt-scan{ opacity:0.16; animation:scan 380ms linear infinite; }
  @keyframes scan{ 0%{ transform:translateY(-100%) } 100%{ transform:translateY(100%) } }
  .pc-crt .screen{ filter:contrast(.6) saturate(.7) brightness(.6) blur(.2px); transform:scaleY(.98); }

  /* common helpers */
  .center-col{ display:flex; flex-direction:column; align-items:center; justify-content:center; width:100%; height:100%; gap:18px; padding:20px; text-align:center; }
  .fade-in{ opacity:0; transform:translateY(8px); transition:opacity 900ms ease, transform 900ms cubic-bezier(.2,.9,.3,1); }
  .show{ opacity:1; transform:none; }

  /* files */
  .files{ display:flex; gap:26px; align-items:flex-end; }
  .file{ width:150px; height:200px; border-radius:12px; border:3px solid var(--accent); background:linear-gradient(180deg,#071018,#0b1116); opacity:0; transform:translateY(40px); transition:all 1200ms cubic-bezier(.22,.9,.38,1); box-shadow: 0 30px 80px rgba(0,0,0,0.6); }
  .file.fly{ opacity:1; transform:none; }

  /* settings */
  .settings{ width:82%; height:70%; border-radius:12px; border:2px solid var(--glass); background:linear-gradient(180deg, rgba(255,255,255,0.02), transparent); position:relative; display:flex; align-items:center; justify-content:center; }
  .color-box{ position:absolute; left:28px; top:22px; width:220px; height:44px; border-radius:10px; border:2px solid var(--accent); display:flex; align-items:center; justify-content:center; background:rgba(0,0,0,0.25); font-weight:700; }
  .color-band{ position:absolute; right:22px; top:22px; width:40px; height:120px; border-radius:8px; overflow:hidden; display:flex; flex-direction:column; gap:6px; padding:4px; }
  .color-seg{ height:24px; opacity:0; transform:translateX(10px); transition:all 1000ms cubic-bezier(.22,.9,.38,1); border-radius:6px; }
  .color-seg.show{ opacity:1; transform:none; }
  .cursor{ width:28px; height:28px; background:#fff; border-radius:6px; position:absolute; box-shadow:0 12px 40px rgba(0,0,0,0.6); transform:translate(-50%,-50%); transition:all 1000ms cubic-bezier(.22,.9,.38,1); }

  /* quads */
  .quad{ position:absolute; box-sizing:border-box; border:2px solid rgba(255,255,255,0.04); display:flex; align-items:center; justify-content:center; font-size:2rem; color:rgba(255,255,255,0.9); opacity:0; transform:scale(.98); transition:all 1000ms cubic-bezier(.22,.9,.38,1); }
  #q1{ left:0; top:0; width:50%; height:50%; } #q2{ right:0; top:0; width:50%; height:50%; } #q3{ right:0; bottom:0; width:50%; height:50%; } #q4{ left:0; bottom:0; width:50%; height:50%; }
  .quad.reveal{ opacity:1; transform:none; }

  /* chat */
  .chat{ width:78%; height:66%; border-radius:12px; border:2px solid var(--glass); background:linear-gradient(180deg, rgba(255,255,255,0.02), transparent); padding:20px; display:flex; flex-direction:column; justify-content:flex-end; gap:10px; }
  .bubble{ max-width:70%; padding:10px 12px; border-radius:12px; background:rgba(255,255,255,0.06); opacity:0; transform:translateX(-8px); transition:opacity 900ms ease, transform 900ms cubic-bezier(.22,.9,.38,1); }
  .bubble.in{ opacity:1; transform:none; }

  /* pdfs */
  .pdf{ width:140px; height:190px; border-radius:10px; background:linear-gradient(180deg,#fff,#e9e9e9); border:2px solid rgba(0,0,0,0.06); box-shadow:0 30px 80px rgba(0,0,0,0.6); opacity:0; transform:translateY(20px) rotate(-2deg); transition:all 1000ms cubic-bezier(.22,.9,.38,1); }
  .pdf.in{ opacity:1; transform:none; }

  /* final */
  .final{ display:flex; flex-direction:column; align-items:center; gap:12px; }
  .date{ font-size:1.4rem; color:#bcd; }

  /* placeholder logo */
  .logo-placeholder{ width:420px; height:160px; border-radius:12px; background:linear-gradient(90deg,#0b1016,#12161a); display:flex;align-items:center;justify-content:center;color:#6da; font-weight:800; letter-spacing:1px; }

  @media (max-width:720px){
    .monitor-frame{ width:96vw; padding:18px; border-radius:12px; }
    .file{ width:110px; height:150px; }
    .pdf{ width:100px; height:140px; }
  }
</style>
</head>
<body>
  <div class="monitor-frame" id="frame" role="application" aria-label="Monitor PekeOS">
    <div class="screen" id="screenArea" aria-live="polite"></div>
    <div id="fadeOverlay"></div>
    <div class="crt-scan" id="crtScan" aria-hidden="true" style="display:none"></div>
    <div class="stand" aria-hidden="true"></div>
  </div>

<script>
/* --- Utilities --- */
const screen = document.getElementById('screenArea');
const fade = document.getElementById('fadeOverlay');
const frame = document.getElementById('frame');
const crtScan = document.getElementById('crtScan');

function sleep(ms){ return new Promise(resolve => setTimeout(resolve, ms)); }
function safe(el, fn){ if(el) try{ fn(el); }catch(e){ console.error(e); } }

// no audio per user request

/* --- durations for internal animations (these control how long each animation inside the scene takes) --- */
const internal = {
  logoShow: 2200,
  filesStagger: 900,   // total time for files fly-ins
  settingsTotal: 3000, // time for color band + cursor path
  quadsStagger: 1400,
  chatBubbles: 1600,
  studyStagger: 1600,
  powerVisual: 1200,
  finalHold: 1800
};

/* overlay helper: fade to black (show=true) or reveal (show=false) */
async function setFade(show=true){
  if(show){
    fade.classList.remove('hidden'); // ensure visible (black)
    // wait for css paint
    await sleep(450);
  }else{
    fade.classList.add('hidden'); // remove black
    // allow reveal transition time
    await sleep(260);
  }
}

/* show content immediately but coordinate inner animations separately */
async function sceneLogo(){
  // monitor is off initially; this function should be called after power-on.
  screen.innerHTML = '';
  const container = document.createElement('div');
  container.className = 'center-col';
  // image element pointing to PekeOS.png (user-provided)
  const img = document.createElement('img');
  img.id = 'logoImg';
  img.alt = 'PekeOS logo';
  img.style.maxWidth = '680px';
  img.style.width = '60%';
  img.style.height = 'auto';
  img.style.borderRadius = '10px';
  img.src = 'PekeOS.png';
  img.onerror = function(){
    const ph = document.createElement('div');
    ph.className = 'logo-placeholder';
    ph.textContent = 'PekeOS';
    img.replaceWith(ph);
  };
  img.className = 'fade-in';
  container.appendChild(img);
  screen.appendChild(container);
  // wait for image to appear then animate
  await sleep(180);
  safe(img, el => el.classList.add('show'));
  await sleep(internal.logoShow);
}

async function sceneFiles(){
  screen.innerHTML = '';
  const wrap = document.createElement('div'); wrap.className = 'center-col';
  const files = document.createElement('div'); files.className = 'files';
  const a = document.createElement('div'); a.id='fA'; a.className='file'; files.appendChild(a);
  const b = document.createElement('div'); b.id='fB'; b.className='file'; files.appendChild(b);
  const c = document.createElement('div'); c.id='fC'; c.className='file'; files.appendChild(c);
  wrap.appendChild(files);
  const txt = document.createElement('div'); txt.id='txt1'; txt.className='fade-in'; txt.style.maxWidth='860px';
  txt.innerHTML = 'La Pekeweb da un paso adelante sin mirar el fracaso,<br>ahora todo en 1 conjunto solo';
  wrap.appendChild(txt);
  screen.appendChild(wrap);
  // staggered fly-ins
  await sleep(260);
  a.classList.add('fly');
  await sleep(360);
  b.classList.add('fly');
  await sleep(360);
  c.classList.add('fly');
  txt.classList.add('show');
  // await remaining time
  await sleep(internal.filesStagger);
}

async function sceneSettings(){
  screen.innerHTML = '';
  const outer = document.createElement('div'); outer.style.width='100%'; outer.style.height='100%'; outer.style.display='flex'; outer.style.alignItems='center'; outer.style.justifyContent='center';
  const settings = document.createElement('div'); settings.className='settings';
  const colorBox = document.createElement('div'); colorBox.className='color-box'; colorBox.textContent='Colores';
  const colorBand = document.createElement('div'); colorBand.className='color-band'; colorBand.id='colorBand';
  const colors = ['#00f6ff','#ff2ec7','#2eff6b','#ffd400'];
  colors.forEach(c => { const s = document.createElement('div'); s.className='color-seg'; s.style.background = c; colorBand.appendChild(s); });
  const cursor = document.createElement('div'); cursor.id='cursorEl'; cursor.className='cursor'; cursor.style.left='14%'; cursor.style.top='62%';
  settings.appendChild(colorBox); settings.appendChild(colorBand); settings.appendChild(cursor);
  outer.appendChild(settings);
  const txt = document.createElement('div'); txt.id='txt2'; txt.className='fade-in'; txt.style.marginLeft='18px'; txt.style.maxWidth='420px';
  txt.innerText = 'Aburrido de que no puedas personalizar la Pekeweb a tu gusto?';
  outer.appendChild(txt);
  screen.appendChild(outer);
  // reveal text quickly
  await sleep(240); txt.classList.add('show');
  // reveal color segments with stagger
  const segs = colorBand.querySelectorAll('.color-seg');
  for(let i=0;i<segs.length;i++){ setTimeout(()=>segs[i].classList.add('show'), i*520); }
  // cursor path: two slow stops
  await sleep(420);
  cursor.style.left='42%'; cursor.style.top='36%';
  await sleep(1000);
  cursor.style.left='72%'; cursor.style.top='50%';
  await sleep(internal.settingsTotal - 1420); // ensure total realistic
}

async function sceneQuads(){
  screen.innerHTML = '';
  const wrap = document.createElement('div'); wrap.style.position='relative'; wrap.style.width='100%'; wrap.style.height='100%';
  ['q1','q2','q3','q4'].forEach(id => { const d = document.createElement('div'); d.id=id; d.className='quad'; d.textContent = id==='q1'?'Ocio':id==='q2'?'Noticias':id==='q3'?'Admin':'Redes'; wrap.appendChild(d); });
  screen.appendChild(wrap);
  // reveal in stagger
  await sleep(260);
  document.getElementById('q1')?.classList.add('reveal');
  await sleep(420);
  document.getElementById('q2')?.classList.add('reveal');
  await sleep(420);
  document.getElementById('q3')?.classList.add('reveal');
  await sleep(420);
  document.getElementById('q4')?.classList.add('reveal');
  await sleep(internal.quadsStagger);
}

async function sceneChat(){
  screen.innerHTML = '';
  const wrap = document.createElement('div'); wrap.style.display='flex'; wrap.style.flexDirection='column'; wrap.style.alignItems='center'; wrap.style.width='100%'; wrap.style.height='100%';
  const chat = document.createElement('div'); chat.className='chat';
  const b1 = document.createElement('div'); b1.id='b1'; b1.className='bubble'; b1.textContent='¡Bienvenido!';
  const b2 = document.createElement('div'); b2.id='b2'; b2.className='bubble'; b2.textContent='Privados y públicos, como quieras.';
  const b3 = document.createElement('div'); b3.id='b3'; b3.className='bubble'; b3.textContent='Comparte con seguridad.';
  chat.appendChild(b1); chat.appendChild(b2); chat.appendChild(b3); wrap.appendChild(chat);
  const t = document.createElement('div'); t.id='txt3'; t.className='fade-in'; t.style.marginTop='14px'; t.style.maxWidth='760px'; t.style.textAlign='center'; t.innerText='Tranquilo, ya tenemos chats privados y públicos'; wrap.appendChild(t);
  screen.appendChild(wrap);
  // bubble reveals
  await sleep(320); b1.classList.add('in');
  await sleep(600); b2.classList.add('in');
  await sleep(600); b3.classList.add('in');
  t.classList.add('show');
  await sleep(internal.chatBubbles);
}

async function sceneStudy(){
  screen.innerHTML = '';
  const wrap = document.createElement('div'); wrap.style.display='flex'; wrap.style.flexDirection='column'; wrap.style.alignItems='center'; wrap.style.width='100%'; wrap.style.height='100%';
  const row = document.createElement('div'); row.style.display='flex'; row.style.gap='22px'; row.style.justifyContent='center'; row.style.alignItems='flex-end';
  for(let i=1;i<=4;i++){ const p = document.createElement('div'); p.id = 'p'+i; p.className='pdf'; row.appendChild(p); }
  wrap.appendChild(row);
  const t = document.createElement('div'); t.id='txt4'; t.className='fade-in'; t.style.marginTop='14px'; t.style.maxWidth='760px'; t.style.textAlign='center'; t.innerHTML='Necesitas estudiar y no tienes apuntes?<br>Revisa por si alguien te ha puesto algo para ayudar';
  wrap.appendChild(t);
  screen.appendChild(wrap);
  // stagger reveal
  await sleep(260); document.getElementById('p1')?.classList.add('in');
  await sleep(360); document.getElementById('p2')?.classList.add('in');
  await sleep(360); document.getElementById('p3')?.classList.add('in');
  await sleep(360); document.getElementById('p4')?.classList.add('in');
  t.classList.add('show');
  await sleep(internal.studyStagger);
}

/* power on / off visuals */
async function powerOnSequence(){
  // monitor is 'off' visually because overlay starts visible; we fade overlay out to simulate power on
  // slight flicker effect:
  // quick tiny flashes by toggling overlay briefly
  await sleep(180);
  // small flicker
  fade.classList.add('hidden'); // reveal
  await sleep(140);
  fade.classList.remove('hidden');
  await sleep(120);
  fade.classList.add('hidden');
  // ensure final visible for a moment
  await sleep(260);
}

async function powerOffSequence(){
  // fade to black then add CRT class to simulate shutdown, quick scanlines then remove
  fade.classList.remove('hidden'); // cover (black)
  await sleep(180);
  // briefly turn on CRT scan overlay for visual
  frame.classList.add('pc-crt');
  crtScan.style.display = 'block';
  await sleep(800);
  frame.classList.remove('pc-crt');
  crtScan.style.display = 'none';
  await sleep(220);
}

/* final reveal: show logo + date */
async function finalReveal(){
  screen.innerHTML = '';
  const wrap = document.createElement('div'); wrap.className = 'final center-col';
  // use user's image if present, fallback will show broken image replaced by placeholder
  const img = document.createElement('img');
  img.id = 'finalLogo';
  img.src = 'PekeOS.png';
  img.alt = 'PekeOS';
  img.style.maxWidth = '680px'; img.style.width='58%'; img.style.height='auto'; img.style.borderRadius='10px';
  img.onerror = function(){
    const ph = document.createElement('div'); ph.className='logo-placeholder'; ph.textContent='PekeOS'; img.replaceWith(ph);
  };
  wrap.appendChild(img);
  const date = document.createElement('div'); date.className='date'; date.textContent = '04/12/25';
  wrap.appendChild(date);
  screen.appendChild(wrap);
  await sleep(200);
  safe(img, el => el.classList.add('show'));
  await sleep(internal.finalHold);
}

/* --- Runner --- */
(async function runner(){
  try{
    // start: monitor off (overlay covers)
    fade.classList.remove('hidden'); // ensure black at start
    // small delay
    await sleep(300);

    // power on (flicker then reveal)
    await powerOnSequence();

    // scene sequence — each awaits internal animations so nothing cuts off
    await sceneLogo();    // logo shown after power on
    await sceneFiles();
    await sceneSettings();
    await sceneQuads();
    await sceneChat();
    await sceneStudy();

    // power off
    await powerOffSequence();

    // final logo + date reveal
    await finalReveal();

    // done — keep final on screen
  }catch(e){
    console.error('Error en trailer sincronizado:', e);
    fade.classList.remove('hidden');
    screen.innerHTML = '<div style="display:flex;align-items:center;justify-content:center;width:100%;height:100%;color:#fff">Error — abre la consola para detalles</div>';
  }
})();
</script>
</body>
</html>
