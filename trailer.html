<!doctype html>
<html lang="es">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Trailer PekeOS — 30s (Funcionando)</title>
<style>
  :root{
    --accent: #00f6ff;
    --bg: #000;
    --glass: rgba(255,255,255,0.04);
  }
  *{box-sizing:border-box}
  html,body{height:100%;margin:0;background:var(--bg);font-family:Inter, system-ui, Arial, sans-serif;color:#fff;display:flex;align-items:center;justify-content:center}
  .pc{width:90%;max-width:1200px;height:78vh;border-radius:16px;background:#020204;border:6px solid #111;box-shadow:0 40px 100px rgba(0,0,0,0.7);position:relative;overflow:hidden}
  .monitor{position:relative;inset:0;width:100%;height:100%;display:flex;align-items:center;justify-content:center;background:#000}
  /* cinematic overlay for fade to black */
  #overlay{position:absolute;inset:0;background:#000;pointer-events:none;opacity:1;transition:opacity 700ms ease;z-index:50}
  #overlay.hidden{opacity:0}
  /* base animate classes */
  .fade{opacity:0;transform:translateY(8px);transition:opacity .8s ease,transform .8s cubic-bezier(.2,.9,.3,1)}
  .in{opacity:1;transform:none}
  /* centered boxes / visuals */
  .center{display:flex;flex-direction:column;align-items:center;justify-content:center;width:100%;height:100%}
  /* files */
  .files{display:flex;gap:20px;align-items:flex-end}
  .file{width:120px;height:160px;border-radius:10px;border:3px solid var(--accent);background:linear-gradient(180deg,#061017,#0b0f14);opacity:0;transform:translateY(40px);transition:all 900ms cubic-bezier(.22,.9,.38,1)}
  .file.fly{opacity:1;transform:none}
  /* settings */
  .settings{width:78%;height:68%;border-radius:14px;border:2px solid var(--glass);background:linear-gradient(180deg,rgba(255,255,255,0.02),transparent);position:relative;overflow:hidden;display:flex;align-items:center;justify-content:center}
  .color-box{position:absolute;left:28px;top:22px;width:210px;height:44px;border-radius:10px;border:2px solid var(--accent);display:flex;align-items:center;justify-content:center;background:rgba(0,0,0,0.25)}
  .cursor{width:26px;height:26px;background:#fff;border-radius:6px;position:absolute;box-shadow:0 8px 26px rgba(0,0,0,0.6);transform:translate(-50%,-50%);transition:all 900ms cubic-bezier(.22,.9,.38,1)}
  .color-band{position:absolute;right:24px;top:24px;width:40px;height:120px;border-radius:8px;overflow:hidden}
  .color-seg{height:28px;opacity:0;transform:translateX(10px);transition:all 900ms cubic-bezier(.22,.9,.38,1)}
  .color-seg.show{opacity:1;transform:none}
  /* quads */
  .quad{position:absolute;box-sizing:border-box;border:2px solid rgba(255,255,255,0.04);display:flex;align-items:center;justify-content:center;font-size:2rem;color:rgba(255,255,255,0.9);opacity:0;transform:scale(.98);transition:all 900ms cubic-bezier(.22,.9,.38,1)}
  #q1{left:0;top:0;width:50%;height:50%}
  #q2{right:0;top:0;width:50%;height:50%}
  #q3{right:0;bottom:0;width:50%;height:50%}
  #q4{left:0;bottom:0;width:50%;height:50%}
  .quad.reveal{opacity:1;transform:none}
  /* chat bubbles */
  .chat{width:76%;height:64%;border-radius:12px;border:2px solid var(--glass);background:linear-gradient(180deg,rgba(255,255,255,0.02),transparent);position:relative;padding:22px}
  .bubble{max-width:60%;padding:10px 12px;border-radius:12px;background:rgba(255,255,255,0.06);margin:10px 0;opacity:0;transform:translateX(-8px);transition:opacity .7s ease,transform .8s cubic-bezier(.22,.9,.38,1)}
  .bubble.in{opacity:1;transform:none}
  /* pdfs */
  .pdf{width:120px;height:160px;border-radius:8px;background:linear-gradient(180deg,#fff,#e9e9e9);border:2px solid rgba(0,0,0,0.06);box-shadow:0 18px 50px rgba(0,0,0,0.6);opacity:0;transform:translateY(10px) rotate(-2deg);transition:all 900ms cubic-bezier(.22,.9,.38,1)}
  .pdf.in{opacity:1;transform:none}
  /* CRT off effect: scanline overlay inside monitor when pc has class .crt-off */
  .crt-scan{position:absolute;inset:0;pointer-events:none;opacity:0;mix-blend-mode:screen;background:linear-gradient(180deg, rgba(255,255,255,0.03) 0%, rgba(255,255,255,0.0) 50%, rgba(255,255,255,0.03) 100%);transition:opacity .15s}
  .crt-on .crt-scan{opacity:0.18;animation:scan 380ms linear infinite}
  @keyframes scan{0%{transform:translateY(-100%)}100%{transform:translateY(100%)}}
  .crt-on .monitor{filter:contrast(.6) saturate(.7) brightness(.6) blur(.2px);transform:scaleY(.98)}
  /* final */
  .final{display:flex;flex-direction:column;align-items:center;gap:12px}
  .date{font-size:1.9rem}
  @media (max-width:900px){ .pc{width:96%;height:86vh} .files{gap:12px} .file{width:86px;height:120px} }
  /* small helper for accessibility (invisible focus outlines) */
  :focus{outline:2px solid rgba(255,255,255,0.06)}
</style>
</head>
<body>
  <div class="pc" id="pc" role="application" aria-label="Tráiler PekeOS">
    <div class="monitor" id="monitor" aria-live="polite">
      <!-- initial blank - will be swapped -->
    </div>
    <div id="overlay"></div>
    <!-- scanline for CRT effect (inserted but hidden by default) -->
    <div id="crt-scan" class="crt-scan" aria-hidden="true"></div>
  </div>

  <!-- Audio placeholders (optional). If no files present, script continues silently -->
  <audio id="sfx-power" preload="auto" src="assets/sfx_power_on.mp3"></audio>
  <audio id="sfx-files" preload="auto" src="assets/sfx_files_open.mp3"></audio>
  <audio id="sfx-click" preload="auto" src="assets/sfx_click.mp3"></audio>
  <audio id="sfx-swoosh" preload="auto" src="assets/sfx_swoosh.mp3"></audio>
  <audio id="music" preload="auto" src="assets/ambient_loop.mp3" loop></audio>

<script>
/*
  Trailer PekeOS - self-contained sequence
  - ~30s total
  - cinematic fade transitions
  - CRT power-off effect
  - uses inline SVG logo so no external images required
  - safe audio play (non-blocking)
*/

function sleep(ms){ return new Promise(resolve => setTimeout(resolve, ms)); }
function tryPlay(a){ if(!a) return; try{ a.currentTime = 0; const p = a.play(); if(p && p.catch) p.catch(()=>{}); }catch(e){} }

// DOM refs
const monitor = document.getElementById('monitor');
const overlay = document.getElementById('overlay');
const pc = document.getElementById('pc');
const crtScan = document.getElementById('crt-scan');
const audio = {
  power: document.getElementById('sfx-power'),
  files: document.getElementById('sfx-files'),
  click: document.getElementById('sfx-click'),
  swoosh: document.getElementById('sfx-swoosh'),
  music: document.getElementById('music')
};

// default durations (ms), sum ~30s
const D = {
  logo: 3000,
  files: 5000,
  settings: 5000,
  quads: 4000,
  chat: 4000,
  study: 4500,
  power: 2000,
  final: 2000
};

// simple inline SVG logo so nothing external breaks
const SVG_LOGO = `
  <svg width="420" height="220" viewBox="0 0 420 220" xmlns="http://www.w3.org/2000/svg" role="img" aria-label="PekeOS logo">
    <defs>
      <linearGradient id="g1" x1="0" x2="1">
        <stop offset="0" stop-color="#00f6ff"/>
        <stop offset="1" stop-color="#9b5cff"/>
      </linearGradient>
    </defs>
    <rect width="420" height="220" rx="20" fill="#071018"/>
    <g transform="translate(40,35)">
      <circle cx="60" cy="50" r="42" fill="url(#g1)" opacity="0.98" />
      <text x="120" y="72" font-family="Inter, Arial, sans-serif" font-size="48" fill="#ffffff" font-weight="700">PekeOS</text>
      <text x="120" y="110" font-family="Inter, Arial, sans-serif" font-size="14" fill="#9fb4c8">Sistema minimalista • Privacidad • Ligero</text>
    </g>
  </svg>
`;

// showScene: fade to black, swap content, fade in, wait duration
async function showScene(html, duration){
  // ensure overlay visible (fade to black)
  overlay.classList.remove('hidden');
  await sleep(420); // allow overlay to take effect
  monitor.innerHTML = html;
  // small paint then reveal
  await sleep(120);
  overlay.classList.add('hidden');
  await sleep(duration);
}

// unlock audio on user gesture (if blocked)
function unlockAudioOnce(){ tryPlay(audio.music); window.removeEventListener('click', unlockAudioOnce); }
window.addEventListener('click', unlockAudioOnce);

// main sequence
(async function main(){
  try{
    // try to start ambient quietly
    tryPlay(audio.music);

    // 1) Logo
    await showScene(`<div class="center"><div class="fade" id="logoWrapper">${SVG_LOGO}</div></div>`, D.logo);
    document.getElementById('logoWrapper')?.classList.add('in');
    tryPlay(audio.power);

    // 2) Files flying + text
    await showScene(`
      <div class="center">
        <div class="files" aria-hidden="false">
          <div id="fA" class="file" role="img" aria-label="archivo A"></div>
          <div id="fB" class="file" role="img" aria-label="archivo B"></div>
          <div id="fC" class="file" role="img" aria-label="archivo C"></div>
        </div>
        <div id="txt1" class="fade" style="margin-top:20px;text-align:center;font-size:1.05rem">
          La Pekeweb da un paso adelante sin mirar el fracaso,<br>ahora todo en 1 conjunto solo
        </div>
      </div>
    `, D.files);
    // staggered fly
    await sleep(160); document.getElementById('fA')?.classList.add('fly');
    await sleep(160); document.getElementById('fB')?.classList.add('fly');
    await sleep(160); document.getElementById('fC')?.classList.add('fly');
    document.getElementById('txt1')?.classList.add('in');
    tryPlay(audio.files);

    // 3) Settings (color band + cursor)
    await showScene(`
      <div style="width:100%;height:100%;display:flex;align-items:center;justify-content:center;">
        <div class="settings" role="region" aria-label="Ajustes">
          <div class="color-box">Colores</div>
          <div class="color-band" id="colorBand">
            <div class="color-seg" style="background:#00f6ff"></div>
            <div class="color-seg" style="background:#ff2ec7"></div>
            <div class="color-seg" style="background:#2eff6b"></div>
            <div class="color-seg" style="background:#ffd400"></div>
          </div>
          <div id="cursorEl" class="cursor" style="left:14%;top:62%;"></div>
        </div>
        <div id="txt2" class="fade" style="margin-left:12px;text-align:center;font-size:1.05rem">
          Aburrido de que no puedas personalizar la Pekeweb a tu gusto?
        </div>
      </div>
    `, D.settings);
    document.getElementById('txt2')?.classList.add('in');
    const segs = document.querySelectorAll('#colorBand .color-seg');
    for(let i=0;i<segs.length;i++){ setTimeout(()=>segs[i].classList.add('show'), i*220); }
    // cursor movement: smooth stops
    const c = document.getElementById('cursorEl');
    if(c){
      c.style.transition = 'all 900ms cubic-bezier(.22,.9,.38,1)';
      await sleep(260);
      c.style.left = '40%'; c.style.top = '36%';
      await sleep(900);
      c.style.left = '70%'; c.style.top = '50%';
    }
    tryPlay(audio.click);

    // 4) Quadrants split
    await showScene(`
      <div style="position:relative;width:100%;height:100%;">
        <div id="q1" class="quad" aria-hidden="false">Ocio</div>
        <div id="q2" class="quad" aria-hidden="false">Noticias</div>
        <div id="q3" class="quad" aria-hidden="false">Admin</div>
        <div id="q4" class="quad" aria-hidden="false">Redes</div>
      </div>
    `, D.quads);
    ['q1','q2','q3','q4'].forEach((id,i)=> setTimeout(()=>document.getElementById(id)?.classList.add('reveal'), i*220));
    tryPlay(audio.swoosh);

    // 5) Chat panel
    await showScene(`
      <div style="display:flex;flex-direction:column;align-items:center;width:100%;">
        <div class="chat" role="region" aria-label="Chat previews">
          <div id="b1" class="bubble">¡Bienvenido!</div>
          <div id="b2" class="bubble">Privados y públicos, como quieras.</div>
          <div id="b3" class="bubble">Comparte con seguridad.</div>
        </div>
        <div id="txt3" class="fade" style="margin-top:12px;text-align:center;font-size:1.05rem">
          Tranquilo, ya tenemos chats privados y públicos
        </div>
      </div>
    `, D.chat);
    setTimeout(()=>document.getElementById('b1')?.classList.add('in'), 200);
    setTimeout(()=>document.getElementById('b2')?.classList.add('in'), 600);
    setTimeout(()=>document.getElementById('b3')?.classList.add('in'), 1000);
    document.getElementById('txt3')?.classList.add('in');
    tryPlay(audio.files);

    // 6) Study PDFs
    await showScene(`
      <div style="display:flex;flex-direction:column;align-items:center;width:100%;">
        <div style="display:flex;gap:20px;justify-content:center">
          <div id="p1" class="pdf" role="img" aria-label="pdf 1"></div>
          <div id="p2" class="pdf" role="img" aria-label="pdf 2"></div>
          <div id="p3" class="pdf" role="img" aria-label="pdf 3"></div>
          <div id="p4" class="pdf" role="img" aria-label="pdf 4"></div>
        </div>
        <div id="txt4" class="fade" style="margin-top:12px;text-align:center;font-size:1.05rem">
          Necesitas estudiar y no tienes apuntes?<br>Revisa por si alguien te ha puesto algo para ayudar
        </div>
      </div>
    `, D.study);
    setTimeout(()=>document.getElementById('p1')?.classList.add('in'), 120);
    setTimeout(()=>document.getElementById('p2')?.classList.add('in'), 300);
    setTimeout(()=>document.getElementById('p3')?.classList.add('in'), 480);
    setTimeout(()=>document.getElementById('p4')?.classList.add('in'), 660);
    document.getElementById('txt4')?.classList.add('in');
    tryPlay(audio.swoosh);

    // 7) Power: CRT effect (turn off)
    await showScene(`
      <div style="display:flex;align-items:center;justify-content:center;width:100%;height:100%;">
        <div class="crt-wrap" style="position:relative;display:flex;align-items:center;justify-content:center;width:100%;height:100%;">
          <div style="font-size:6rem;color:#fff">⏻</div>
          <div class="crt-scan" aria-hidden="true"></div>
        </div>
      </div>
    `, D.power);
    // activate CRT look briefly (class on pc)
    pc.classList.add('crt-on');
    tryPlay(audio.click);
    await sleep(900);
    pc.classList.remove('crt-on');

    // final: fade to black and reveal logo + date
    overlay.classList.remove('hidden'); // fade to black
    await sleep(420);
    monitor.innerHTML = `
      <div class="final fade" id="finalWrap" style="display:flex;flex-direction:column;align-items:center;justify-content:center;height:100%;">
        ${SVG_LOGO}
        <div class="date" style="margin-top:18px">04/12/25</div>
      </div>
    `;
    await sleep(120);
    document.getElementById('finalWrap')?.classList.add('in');
    overlay.classList.add('hidden');
    try{ if(audio.music){ audio.music.pause(); audio.music.currentTime = 0; } }catch(e){}
  }catch(err){
    // Safe error reporting: overlay visible + console
    overlay.classList.remove('hidden');
    console.error('Error en secuencia del tráiler:', err);
  }
})();
</script>
</body>
</html>
