<!doctype html>
<html lang="es">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>PekeOS — Trailer (Monitor B, Cinemático lento)</title>
<style>
  :root{
    --bg:#0a0a0c; --monitor:#071018; --bezel:#111216; --accent:#00f6ff;
    --glass: rgba(255,255,255,0.04);
  }
  *{box-sizing:border-box}
  html,body{height:100%;margin:0;background:linear-gradient(180deg,#05060a,#0b0d10);font-family:Inter,system-ui,Arial,sans-serif;color:#fff;display:flex;align-items:center;justify-content:center}
  /* Monitor frame (retro curvado) */
  .monitor-frame{
    width:1000px; max-width:95vw; aspect-ratio:16/9; height:auto;
    background:linear-gradient(180deg,var(--bezel),#0b0b0d);
    border-radius:28px; padding:26px;
    box-shadow: 0 45px 120px rgba(0,0,0,0.75), inset 0 6px 20px rgba(255,255,255,0.02);
    position:relative; display:flex; align-items:center; justify-content:center;
  }
  /* stand */
  .stand{
    position:absolute; bottom:-48px; left:50%; transform:translateX(-50%); width:260px; height:48px; background:linear-gradient(180deg,#0c0c0d,#0a0a0b); border-radius:8px; box-shadow:0 20px 40px rgba(0,0,0,0.6);
  }

  /* Screen area (inner) */
  .screen{
    width:100%; height:100%; background:var(--monitor); border-radius:12px; overflow:hidden; position:relative; display:flex; align-items:center; justify-content:center;
    box-shadow: inset 0 0 60px rgba(0,0,0,0.6);
  }

  /* cinematic fade overlay (A) */
  #fadeOverlay{ position:absolute; inset:0; background:#000; pointer-events:none; opacity:1; transition:opacity 900ms ease; z-index:50; }
  #fadeOverlay.hidden{ opacity:0; }

  /* common animation helpers (slow/cinematic) */
  .fade-in { opacity:0; transform:translateY(6px); transition:opacity 900ms ease, transform 900ms cubic-bezier(.2,.9,.3,1); }
  .fade-in.show { opacity:1; transform:none; }

  .center-col{ display:flex; flex-direction:column; align-items:center; justify-content:center; width:100%; height:100%; padding:24px; gap:18px; text-align:center; }

  /* files */
  .files{ display:flex; gap:26px; align-items:flex-end; }
  .file{ width:150px; height:200px; border-radius:12px; border:3px solid var(--accent); background:linear-gradient(180deg,#071018,#0b1116); transform:translateY(40px); opacity:0; transition:all 1200ms cubic-bezier(.22,.9,.38,1); box-shadow: 0 30px 80px rgba(0,0,0,0.6);}
  .file.fly{ transform:none; opacity:1; }

  /* settings */
  .settings{ width:82%; height:70%; border-radius:12px; border:2px solid var(--glass); background:linear-gradient(180deg, rgba(255,255,255,0.02), transparent); position:relative; display:flex; align-items:center; justify-content:center; }
  .color-box{ position:absolute; left:28px; top:22px; width:220px; height:44px; border-radius:10px; border:2px solid var(--accent); display:flex; align-items:center; justify-content:center; background:rgba(0,0,0,0.25); font-weight:600; }
  .color-band{ position:absolute; right:22px; top:22px; width:40px; height:120px; border-radius:8px; overflow:hidden; display:flex; flex-direction:column; gap:6px; padding:4px; }
  .color-seg{ height:24px; opacity:0; transform:translateX(10px); transition:all 1000ms cubic-bezier(.22,.9,.38,1); border-radius:6px; }
  .color-seg.show{ opacity:1; transform:none; }

  .cursor{ width:28px; height:28px; background:#fff; border-radius:6px; position:absolute; box-shadow:0 12px 40px rgba(0,0,0,0.6); transform:translate(-50%,-50%); transition:all 1000ms cubic-bezier(.22,.9,.38,1); }

  /* quadrants */
  .quad{ position:absolute; box-sizing:border-box; border:2px solid rgba(255,255,255,0.04); display:flex; align-items:center; justify-content:center; font-size:2rem; color:rgba(255,255,255,0.9); opacity:0; transform:scale(.98); transition:all 1000ms cubic-bezier(.22,.9,.38,1); }
  #q1{ left:0; top:0; width:50%; height:50%; }
  #q2{ right:0; top:0; width:50%; height:50%; }
  #q3{ right:0; bottom:0; width:50%; height:50%; }
  #q4{ left:0; bottom:0; width:50%; height:50%; }
  .quad.reveal{ opacity:1; transform:none; }

  /* chat */
  .chat{ width:78%; height:66%; border-radius:12px; border:2px solid var(--glass); background:linear-gradient(180deg, rgba(255,255,255,0.02), transparent); padding:20px; display:flex; flex-direction:column; justify-content:flex-end; gap:10px; }
  .bubble{ max-width:70%; padding:12px 14px; border-radius:12px; background:rgba(255,255,255,0.06); opacity:0; transform:translateX(-8px); transition:opacity 900ms ease, transform 900ms cubic-bezier(.22,.9,.38,1); }
  .bubble.in{ opacity:1; transform:none; }

  /* pdfs */
  .pdf{ width:140px; height:190px; border-radius:10px; background:linear-gradient(180deg,#fff,#e9e9e9); border:2px solid rgba(0,0,0,0.06); box-shadow:0 30px 80px rgba(0,0,0,0.6); opacity:0; transform:translateY(20px) rotate(-2deg); transition:all 1000ms cubic-bezier(.22,.9,.38,1); }
  .pdf.in{ opacity:1; transform:none; }

  /* CRT scan effect for power off (B) */
  .crt-scan{ position:absolute; inset:0; pointer-events:none; opacity:0; mix-blend-mode:screen; background:linear-gradient(180deg, rgba(255,255,255,0.03) 0%, rgba(255,255,255,0.0) 50%, rgba(255,255,255,0.03) 100%); transition:opacity 180ms linear; }
  .pc-crt .crt-scan{ opacity:0.16; animation:scan 380ms linear infinite; }
  @keyframes scan{ 0%{ transform:translateY(-100%) } 100%{ transform:translateY(100%) } }
  .pc-crt .screen{ filter:contrast(.6) saturate(.7) brightness(.6) blur(.2px); transform:scaleY(.98); }

  /* final */
  .final{ display:flex; flex-direction:column; align-items:center; gap:12px; }
  .date{ font-size:1.4rem; color:#bcd; }
  /* fallback placeholder for logo missing */
  .logo-placeholder{ width:420px; height:160px; border-radius:12px; background:linear-gradient(90deg,#0b1016,#12161a); display:flex;align-items:center;justify-content:center;color:#6da; font-weight:700; letter-spacing:1px; }

  /* responsive ensure it's still monitor-like on small screens */
  @media (max-width:720px){
    .monitor-frame{ width:96vw; border-radius:12px; padding:18px; }
    .logo-placeholder, img#logoImg{ width:90%; height:auto; }
  }

</style>
</head>
<body>
  <div class="monitor-frame" id="frame" role="application" aria-label="Monitor PekeOS">
    <div class="screen" id="screenArea">
      <!-- content will be swapped by JS -->
    </div>

    <!-- cinematic fade overlay (A) -->
    <div id="fadeOverlay"></div>

    <!-- CRT scan element (for B) -->
    <div class="crt-scan" id="crtScan" aria-hidden="true"></div>

    <!-- stand / base -->
    <div class="stand" aria-hidden="true"></div>
  </div>

  <!-- optional audio placeholders (won't break if missing) -->
  <audio id="sfx-power" preload="auto" src="assets/sfx_power_on.mp3"></audio>
  <audio id="sfx-files" preload="auto" src="assets/sfx_files_open.mp3"></audio>
  <audio id="sfx-click" preload="auto" src="assets/sfx_click.mp3"></audio>
  <audio id="sfx-swoosh" preload="auto" src="assets/sfx_swoosh.mp3"></audio>
  <audio id="music" preload="auto" src="assets/ambient_loop.mp3" loop></audio>

<script>
/* Trailer runner — monitor B (CRT), cinematic slow pacing.
   Uses your logo file: "PekeOS.png" (same folder). If absent, shows placeholder.
*/

const screen = document.getElementById('screenArea');
const fade = document.getElementById('fadeOverlay');
const crtScan = document.getElementById('crtScan');
const frame = document.getElementById('frame');
const audio = {
  power: document.getElementById('sfx-power'),
  files: document.getElementById('sfx-files'),
  click: document.getElementById('sfx-click'),
  swoosh: document.getElementById('sfx-swoosh'),
  music: document.getElementById('music')
};

function sleep(ms){ return new Promise(resolve => setTimeout(resolve, ms)); }
function tryPlay(a){ if(!a) return; try{ a.currentTime = 0; const p = a.play(); if(p && p.catch) p.catch(()=>{}); }catch(e){} }

// durations (slower, cinematic) — sum ≈ 30s
const DUR = {
  logo: 4000,
  files: 6000,
  settings: 6000,
  quads: 4200,
  chat: 4200,
  study: 5000,
  power: 2000,
  final: 2000
};

// helper: safe swap with cinematic fade (A)
async function showScene(html, duration){
  // fade to black
  fade.classList.remove('hidden'); // visible overlay
  await sleep(500);
  // put content
  screen.innerHTML = html;
  await sleep(200);
  // reveal
  fade.classList.add('hidden');
  await sleep(duration);
}

// put logo image (user-supplied: "PekeOS.png")
function logoElement(){
  // try to reference provided filename; if missing, show placeholder
  const img = document.createElement('img');
  img.id = 'logoImg';
  img.alt = 'PekeOS logo';
  img.className = 'fade-in';
  img.style.maxWidth = '540px';
  img.style.width = '68%';
  img.style.height = 'auto';
  img.src = 'PekeOS.png'; // user-specified filename
  // if image fails to load, replace with placeholder
  img.onerror = function(){
    const ph = document.createElement('div');
    ph.className = 'logo-placeholder';
    ph.textContent = 'PekeOS';
    img.replaceWith(ph);
  };
  return img;
}

// unlock audio on user gesture if needed
function unlockAudioOnce(){ tryPlay(audio.music); window.removeEventListener('click', unlockAudioOnce); }
window.addEventListener('click', unlockAudioOnce);

// main sequence (async)
(async function run(){
  try{
    // try background music (non-blocking)
    tryPlay(audio.music);

    // 1 — Logo (slow)
    await showScene('', 200); // ensure overlay covers momentarily
    // fill with logo
    screen.innerHTML = `<div class="center-col" style="gap:18px"></div>`;
    const wrap = screen.querySelector('.center-col');
    const lg = logoElement();
    wrap.appendChild(lg);
    // reveal after small delay
    await sleep(240);
    lg.classList.add('show');
    tryPlay(audio.power);
    await sleep(DUR.logo - 240);

    // 2 — Files flying + text
    await showScene(`
      <div class="center-col">
        <div class="files" role="list" aria-label="Archivos">
          <div id="fA" class="file" role="img" aria-label="Archivo 1"></div>
          <div id="fB" class="file" role="img" aria-label="Archivo 2"></div>
          <div id="fC" class="file" role="img" aria-label="Archivo 3"></div>
        </div>
        <div id="txt1" class="fade-in" style="max-width:860px;font-size:1.05rem;color:#cfe">La Pekeweb da un paso adelante sin mirar el fracaso,<br>ahora todo en 1 conjunto solo</div>
      </div>
    `, DUR.files);
    // staggered fly-in (slower)
    await sleep(300); document.getElementById('fA')?.classList.add('fly');
    await sleep(400); document.getElementById('fB')?.classList.add('fly');
    await sleep(400); document.getElementById('fC')?.classList.add('fly');
    document.getElementById('txt1')?.classList.add('show');
    tryPlay(audio.files);
    // remain on scene for remainder handled by showScene duration

    // 3 — Settings with color band and cursor (cinematic slow)
    await showScene(`
      <div style="display:flex;align-items:center;justify-content:center;width:100%;height:100%">
        <div class="settings" role="region" aria-label="Panel de ajustes">
          <div class="color-box">Colores</div>
          <div class="color-band" id="colorBand">
            <div class="color-seg" style="background:#00f6ff"></div>
            <div class="color-seg" style="background:#ff2ec7"></div>
            <div class="color-seg" style="background:#2eff6b"></div>
            <div class="color-seg" style="background:#ffd400"></div>
          </div>
          <div id="cursorEl" class="cursor" style="left:14%;top:62%"></div>
        </div>
        <div id="txt2" class="fade-in" style="margin-left:18px;max-width:420px;font-size:1.05rem;color:#cfe">
          Aburrido de que no puedas personalizar la Pekeweb a tu gusto?
        </div>
      </div>
    `, DUR.settings);
    document.getElementById('txt2')?.classList.add('show');
    // reveal color segments slowly
    const segs = document.querySelectorAll('#colorBand .color-seg');
    for(let i=0;i<segs.length;i++){ setTimeout(()=>segs[i].classList.add('show'), i*520); }
    // cursor path: 2 stops (slow)
    const cur = document.getElementById('cursorEl');
    if(cur){
      await sleep(420);
      cur.style.left = '42%'; cur.style.top = '36%';
      await sleep(1000);
      cur.style.left = '72%'; cur.style.top = '50%';
    }
    tryPlay(audio.click);

    // 4 — Quadrants (smooth reveal)
    await showScene(`
      <div style="position:relative;width:100%;height:100%;">
        <div id="q1" class="quad">Ocio</div>
        <div id="q2" class="quad">Noticias</div>
        <div id="q3" class="quad">Admin</div>
        <div id="q4" class="quad">Redes</div>
      </div>
    `, DUR.quads);
    ['q1','q2','q3','q4'].forEach((id,i)=> setTimeout(()=>document.getElementById(id)?.classList.add('reveal'), i*420));
    tryPlay(audio.swoosh);

    // 5 — Chat panel with bubbles
    await showScene(`
      <div style="display:flex;flex-direction:column;align-items:center;width:100%;height:100%">
        <div class="chat" role="region" aria-label="Chat">
          <div id="b1" class="bubble">¡Bienvenido!</div>
          <div id="b2" class="bubble">Privados y públicos, como quieras.</div>
          <div id="b3" class="bubble">Comparte con seguridad.</div>
        </div>
        <div id="txt3" class="fade-in" style="margin-top:14px;max-width:760px;font-size:1.05rem;color:#cfe">Tranquilo, ya tenemos chats privados y públicos</div>
      </div>
    `, DUR.chat);
    setTimeout(()=>document.getElementById('b1')?.classList.add('in'), 320);
    setTimeout(()=>document.getElementById('b2')?.classList.add('in'), 920);
    setTimeout(()=>document.getElementById('b3')?.classList.add('in'), 1520);
    document.getElementById('txt3')?.classList.add('show');
    tryPlay(audio.files);

    // 6 — Study: PDFs appear (staggered)
    await showScene(`
      <div style="display:flex;flex-direction:column;align-items:center;width:100%;height:100%">
        <div style="display:flex;gap:22px;justify-content:center;align-items:flex-end;">
          <div id="p1" class="pdf" role="img" aria-label="pdf 1"></div>
          <div id="p2" class="pdf" role="img" aria-label="pdf 2"></div>
          <div id="p3" class="pdf" role="img" aria-label="pdf 3"></div>
          <div id="p4" class="pdf" role="img" aria-label="pdf 4"></div>
        </div>
        <div id="txt4" class="fade-in" style="margin-top:14px;max-width:760px;font-size:1.05rem;color:#cfe">
          Necesitas estudiar y no tienes apuntes?<br>Revisa por si alguien te ha puesto algo para ayudar
        </div>
      </div>
    `, DUR.study);
    setTimeout(()=>document.getElementById('p1')?.classList.add('in'), 260);
    setTimeout(()=>document.getElementById('p2')?.classList.add('in'), 620);
    setTimeout(()=>document.getElementById('p3')?.classList.add('in'), 980);
    setTimeout(()=>document.getElementById('p4')?.classList.add('in'), 1340);
    document.getElementById('txt4')?.classList.add('show');
    tryPlay(audio.swoosh);

    // 7 — Power off (CRT B effect)
    // Fade -> show big power icon and CRT scan, then toggle crt class
    await showScene(`
      <div style="display:flex;align-items:center;justify-content:center;width:100%;height:100%;">
        <div style="font-size:6rem;color:#fff">⏻</div>
      </div>
    `, DUR.power);
    // toggle CRT class on frame to simulate shutting effect
    frame.classList.add('pc-crt');
    crtScan.style.display = 'block';
    tryPlay(audio.click);
    await sleep(900);
    frame.classList.remove('pc-crt');
    crtScan.style.display = 'none';

    // final reveal: fade to black then logo + date (slow)
    fade.classList.remove('hidden'); // ensure black
    await sleep(420);
    // final content with user's logo (same filename)
    const finalHTML = `
      <div style="display:flex;flex-direction:column;align-items:center;justify-content:center;height:100%;gap:18px">
        <img id="finalLogo" src="PekeOS.png" alt="PekeOS" style="max-width:680px;width:58%;height:auto;border-radius:10px" onerror="this.replaceWith(document.createElement('div')).textContent='PekeOS';">
        <div class="date">04/12/25</div>
      </div>
    `;
    screen.innerHTML = finalHTML;
    await sleep(200);
    // reveal final (un-fade)
    document.getElementById('finalLogo')?.classList?.add('show');
    fade.classList.add('hidden');
    // stop music if any
    try{ if(audio.music){ audio.music.pause(); audio.music.currentTime=0; } }catch(e){}
    // trailer finished
  }catch(err){
    // if anything fails, show a minimal fallback so user isn't left with black screen
    console.error('Trailer error:', err);
    fade.classList.remove('hidden');
    screen.innerHTML = '<div style="display:flex;align-items:center;justify-content:center;width:100%;height:100%;color:#fff">Ha ocurrido un error — revisa la consola</div>';
  }
})();
</script>
</body>
</html>
