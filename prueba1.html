<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Vampire Survival - Versión Web Completa</title>
<style>
  /* RESET Y BODY */
  * { margin:0; padding:0; box-sizing:border-box; font-family:Arial, sans-serif; }
  body { background:#111; color:#eee; overflow:hidden; }

  /* MENÚ PRINCIPAL */
  #menu { position:absolute; top:0; left:0; width:100%; height:100%; background:#111; display:flex; flex-direction:column; align-items:center; justify-content:center; }
  #menu h1 { font-size:3em; margin-bottom:40px; }
  .menu-btn { padding:15px 30px; margin:10px; background:#222; border:none; color:#eee; font-size:1.2em; cursor:pointer; transition:0.2s; }
  .menu-btn:hover { background:#444; }

  /* PANTALLA DE SELECCIÓN DE PERSONAJE */
  #character-select { position:absolute; top:0; left:0; width:100%; height:100%; background:#111; display:none; flex-direction:column; align-items:center; justify-content:center; }
  .character { width:150px; height:150px; margin:20px; border:2px solid #555; display:flex; align-items:center; justify-content:center; cursor:pointer; transition:0.3s; opacity:0.5; }
  .character.unlocked { opacity:1; border-color:#0f0; }
  .character.selected { border-color:#ff0; }
  #characters-container { display:flex; }

  /* JUEGO */
  #gameCanvas { display:none; background:#111; }

  /* HUD */
  #hud { position:absolute; top:10px; left:10px; color:#eee; font-size:1.2em; }
  #hud div { margin-bottom:5px; }

  /* BARRAS */
  .bar-container { width:150px; height:20px; background:#333; border:1px solid #555; margin-bottom:5px; }
  .bar { height:100%; background:#0f0; width:100%; }

</style>
</head>
<body>

<!-- MENÚ PRINCIPAL -->
<div id="menu">
  <h1>Vampire Survival</h1>
  <button class="menu-btn" id="playBtn">Jugar</button>
  <button class="menu-btn" id="reportBtn">Informe</button>
  <button class="menu-btn" id="backBtn">Volver</button>
</div>

<!-- PANTALLA DE SELECCIÓN DE PERSONAJE -->
<div id="character-select">
  <h2>Selecciona tu personaje</h2>
  <div id="characters-container">
    <div class="character unlocked" data-name="Pistolero">Pistolero</div>
    <div class="character" data-name="Cazador">Cazador</div>
    <div class="character" data-name="Mago">Mago</div>
    <div class="character" data-name="Vampiro">Vampiro</div>
  </div>
  <button class="menu-btn" id="startGameBtn">Comenzar</button>
</div>

<!-- CANVAS DE JUEGO -->
<canvas id="gameCanvas" width="800" height="600"></canvas>

<!-- HUD -->
<div id="hud">
  <div id="timer">Tiempo: 0s</div>
  <div id="healthBarContainer" class="bar-container"><div id="healthBar" class="bar"></div></div>
  <div id="xpBarContainer" class="bar-container"><div id="xpBar" class="bar"></div></div>
  <div id="points">Puntos: 0</div>
</div>

<script>
/* VARIABLES GENERALES */
const menu = document.getElementById('menu');
const playBtn = document.getElementById('playBtn');
const reportBtn = document.getElementById('reportBtn');
const backBtn = document.getElementById('backBtn');
const characterSelect = document.getElementById('character-select');
const characters = document.querySelectorAll('.character');
const startGameBtn = document.getElementById('startGameBtn');
const gameCanvas = document.getElementById('gameCanvas');
const ctx = gameCanvas.getContext('2d');

const hud = document.getElementById('hud');
const timerEl = document.getElementById('timer');
const healthBar = document.getElementById('healthBar');
const xpBar = document.getElementById('xpBar');
const pointsEl = document.getElementById('points');

let selectedCharacter = null;
let gameInterval, spawnInterval, timerInterval;
let time = 0, health = 100, xp = 0, points = 0;

/* FUNCIONES MENÚ */
playBtn.addEventListener('click', () => {
  menu.style.display = 'none';
  characterSelect.style.display = 'flex';
});

reportBtn.addEventListener('click', () => alert("Informe aún no implementado."));
backBtn.addEventListener('click', () => alert("Volviendo al menú principal..."));

/* SELECCIÓN DE PERSONAJE */
characters.forEach(char => {
  if(char.classList.contains('unlocked')){
    char.addEventListener('click', () => {
      characters.forEach(c => c.classList.remove('selected'));
      char.classList.add('selected');
      selectedCharacter = char.dataset.name;
    });
  }
});

startGameBtn.addEventListener('click', () => {
  if(!selectedCharacter) { alert("Selecciona un personaje desbloqueado."); return; }
  characterSelect.style.display = 'none';
  gameCanvas.style.display = 'block';
  hud.style.display = 'block';
  startGame();
});

/* INICIO DEL JUEGO */
function startGame(){
  health = 100; xp = 0; points = 0; time = 0;
  timerEl.textContent = `Tiempo: ${time}s`;
  healthBar.style.width = `${health}%`;
  xpBar.style.width = `${xp}%`;
  pointsEl.textContent = `Puntos: ${points}`;
  
  // Bucle principal de juego
  gameInterval = setInterval(gameLoop, 16);
  spawnInterval = setInterval(spawnEnemy, 1500); // frecuencia original
  timerInterval = setInterval(() => {
    time++;
    timerEl.textContent = `Tiempo: ${time}s`;
    if(time % 150 === 0) spawnBoss();
  }, 1000);
}

/* FUNCIONES DEL JUEGO */
function gameLoop(){
  // Limpiar canvas
  ctx.fillStyle = '#111';
  ctx.fillRect(0,0,gameCanvas.width,gameCanvas.height);

  // Aquí irían movimientos, disparos, enemigos, etc.
  // TODO: agregar lógica completa de juego como en versión anterior estable
}

function spawnEnemy(){
  // Aparece un enemigo en coordenadas aleatorias
  console.log("Enemigo aparecido");
}

function spawnBoss(){
  console.log("Boss aparecido!");
}

/* FUNCIONES HUD */
function updateHealth(amount){
  health = Math.max(0, Math.min(100, health + amount));
  healthBar.style.width = `${health}%`;
}

function updateXP(amount){
  xp = Math.max(0, Math.min(100, xp + amount));
  xpBar.style.width = `${xp}%`;
}

function updatePoints(amount){
  points += amount;
  pointsEl.textContent = `Puntos: ${points}`;
}

</script>
</body>
</html>
