<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Vampire Survival</title>
<style>
body{margin:0;overflow:hidden;background:#000;color:#fff;font-family:sans-serif}
#ui{position:absolute;top:10px;left:10px;z-index:10}
#menu{position:absolute;top:0;left:0;width:100%;height:100%;background:#000a;display:flex;flex-direction:column;align-items:center;justify-content:center}
button{padding:10px 20px;margin:10px;font-size:18px;background:#222;color:#fff;border:2px solid #555;cursor:pointer;border-radius:8px}
button:hover{background:#444}
#hud{position:absolute;top:10px;left:10px;font-size:18px}
#gameover{position:absolute;top:0;left:0;width:100%;height:100%;background:#000a;display:flex;align-items:center;justify-content:center;font-size:32px;flex-direction:column}
#weapon-select{display:flex;flex-direction:column;align-items:center;justify-content:center;height:100vh;background:#111;color:white}
.weapon-button{margin:10px;padding:10px 20px;background:#222;color:#fff;border:2px solid #555;cursor:pointer;border-radius:8px;font-size:18px}
.weapon-button:hover{background:#444}
</style>
</head>
<body>
<div id="menu">
<h1>Vampire Survival</h1>
<button id="startBtn">Iniciar Juego</button>
</div>
<div id="hud" style="display:none;">Vida: <span id="vida">100</span></div>
<div id="gameover" style="display:none;">
  <div>ðŸ’€ Has muerto ðŸ’€</div>
  <button id="restartBtn">Reiniciar</button>
</div>
<canvas id="gameCanvas"></canvas>
<script>
const canvas=document.getElementById("gameCanvas");
const ctx=canvas.getContext("2d");
canvas.width=window.innerWidth;
canvas.height=window.innerHeight;

let player={x:canvas.width/2,y:canvas.height/2,size:20,speed:4,vida:100};
let enemies=[];
let bullets=[];
let gameRunning=false;
let keys={};
let spawnInterval;
let weapon="basic";

document.addEventListener("keydown",e=>keys[e.key]=true);
document.addEventListener("keyup",e=>keys[e.key]=false);

function startGame(){
  document.getElementById("menu").style.display="none";
  document.getElementById("hud").style.display="block";
  document.getElementById("gameover").style.display="none";
  player.vida=100;
  enemies=[];
  bullets=[];
  gameRunning=true;
  spawnEnemies();
  gameLoop();
}

function endGame(){
  gameRunning=false;
  clearInterval(spawnInterval);
  document.getElementById("gameover").style.display="flex";
}

function spawnEnemies(){
  spawnInterval=setInterval(()=>{
    let side=Math.floor(Math.random()*4);
    let x,y;
    if(side===0){x=0;y=Math.random()*canvas.height;}
    else if(side===1){x=canvas.width;y=Math.random()*canvas.height;}
    else if(side===2){x=Math.random()*canvas.width;y=0;}
    else{ x=Math.random()*canvas.width;y=canvas.height;}
    enemies.push({x,y,size:20,speed:1.5});
  },1000);
}

function movePlayer(){
  if(keys["w"]||keys["ArrowUp"])player.y-=player.speed;
  if(keys["s"]||keys["ArrowDown"])player.y+=player.speed;
  if(keys["a"]||keys["ArrowLeft"])player.x-=player.speed;
  if(keys["d"]||keys["ArrowRight"])player.x+=player.speed;
}

function shoot(){
  bullets.push({x:player.x,y:player.y,dx:Math.cos(Math.random()*2*Math.PI)*5,dy:Math.sin(Math.random()*2*Math.PI)*5});
}

setInterval(()=>{if(gameRunning)shoot();},500);

function update(){
  movePlayer();
  bullets.forEach(b=>{b.x+=b.dx;b.y+=b.dy;});
  enemies.forEach(e=>{
    let dx=player.x-e.x,dy=player.y-e.y;
    let dist=Math.hypot(dx,dy);
    e.x+=e.speed*dx/dist;
    e.y+=e.speed*dy/dist;
    if(dist<player.size+e.size){
      player.vida-=0.5;
      if(player.vida<=0){endGame();}
    }
  });
  bullets.forEach((b,bi)=>{
    enemies.forEach((e,ei)=>{
      if(Math.hypot(b.x-e.x,b.y-e.y)<e.size){
        enemies.splice(ei,1);
        bullets.splice(bi,1);
      }
    });
  });
  document.getElementById("vida").textContent=Math.max(0,Math.floor(player.vida));
}

function draw(){
  ctx.clearRect(0,0,canvas.width,canvas.height);

  // Fondo cuadriculado tenue
  ctx.strokeStyle="#111";
  ctx.lineWidth=1;
  for(let i=0;i<canvas.width;i+=80){
    for(let j=0;j<canvas.height;j+=80){
      ctx.strokeRect(i,j,80,80);
    }
  }

  // Jugador
  ctx.fillStyle="red";
  ctx.beginPath();
  ctx.arc(player.x,player.y,player.size,0,Math.PI*2);
  ctx.fill();

  // Balas
  ctx.fillStyle="lime";
  bullets.forEach(b=>{
    ctx.beginPath();
    ctx.arc(b.x,b.y,5,0,Math.PI*2);
    ctx.fill();
  });

  // Enemigos
  ctx.fillStyle="white";
  enemies.forEach(e=>{
    ctx.beginPath();
    ctx.arc(e.x,e.y,e.size,0,Math.PI*2);
    ctx.fill();
  });
}

function gameLoop(){
  if(!gameRunning)return;
  update();
  draw();
  requestAnimationFrame(gameLoop);
}

document.getElementById("startBtn").onclick=startGame;
document.getElementById("restartBtn").onclick=startGame;

window.addEventListener("resize",()=>{
  canvas.width=window.innerWidth;
  canvas.height=window.innerHeight;
});
</script>
</body>
</html>
